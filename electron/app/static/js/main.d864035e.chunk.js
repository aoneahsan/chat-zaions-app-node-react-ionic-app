(this["webpackJsonpchat-zaions"]=this["webpackJsonpchat-zaions"]||[]).push([[0],{116:function(e,t,a){},145:function(e,t,a){e.exports=a.p+"static/media/ring.131ca3e6.mp3"},149:function(e,t,a){e.exports=a.p+"static/media/message.771482bc.mp3"},156:function(e,t,a){e.exports=a(319)},161:function(e,t,a){},183:function(e,t,a){},189:function(e,t,a){},190:function(e,t,a){},191:function(e,t,a){},208:function(e,t,a){},210:function(e,t,a){},211:function(e,t,a){},214:function(e,t,a){},215:function(e,t,a){},216:function(e,t,a){},217:function(e,t,a){},218:function(e,t,a){},220:function(e,t,a){},221:function(e,t,a){},222:function(e,t,a){},223:function(e,t,a){},224:function(e,t,a){},225:function(e,t,a){},226:function(e,t,a){},227:function(e,t,a){},228:function(e,t,a){},230:function(e,t,a){},235:function(e,t,a){},236:function(e,t,a){},237:function(e,t,a){},274:function(e,t,a){},275:function(e,t,a){},276:function(e,t,a){},277:function(e,t,a){},278:function(e,t,a){},279:function(e,t,a){},280:function(e,t,a){},281:function(e,t,a){},282:function(e,t,a){},283:function(e,t,a){},284:function(e,t,a){},285:function(e,t,a){},286:function(e,t,a){},287:function(e,t,a){},288:function(e,t,a){},289:function(e,t,a){},291:function(e,t,a){},292:function(e,t,a){},315:function(e,t){},318:function(e,t){t.promise=function(e){return function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(n){e.emit(t,a,n)}))}}},319:function(e,t,a){"use strict";a.r(t);var n,r,c,l,o=a(0),s=a.n(o),i=a(37),u=a.n(i),m=(a(161),a(1)),d=a(15),f=(a(183),a(22)),p=a(21),b=a(3),v=a(70),E=a.n(v),h=a(13),g=(a(189),a(190),a(5)),O={demo:!1,brand:"Zaions.com",appName:"Chat",showCredits:!0,url:"http://localhost:4000"},k=function(e){var t=e.user,a=void 0===t?{}:t,n=e.group,r=void 0!==n&&n,c=e.picture,l=e.title,o=void 0===l?"Group":l;if(r)return c?s.a.createElement("img",{src:"".concat(O.url||"","/api/images/").concat(c.shieldedID,"/256"),alt:"Picture",className:"picture"}):s.a.createElement("div",{className:"img"},o.substr(0,1).toUpperCase());var i=a.firstName||"User",u=a.lastName||"Name";return a.picture?s.a.createElement("img",{src:"".concat(O.url||"","/api/images/").concat(a.picture.shieldedID,"/256"),alt:"Picture",className:"picture"}):s.a.createElement("div",{className:"img"},i.substr(0,1).toUpperCase(),u.substr(0,1).toUpperCase())},N=function(){var e=Object(m.useGlobal)("panel")[1],t={title:"Group",isGroup:!0},a=Object(m.useGlobal)("groupTitle")[0];return s.a.createElement("div",{className:"top-bar-group uk-flex uk-flex-between uk-flex-middle"},s.a.createElement("div",{className:"nav"},s.a.createElement("div",{className:"button",onClick:function(){return e("standard")}},s.a.createElement(g.a,null)),s.a.createElement("div",{className:"profile conversation"},s.a.createElement(k,{user:t,group:t.isGroup,picture:t.picture,title:t.title})),s.a.createElement("div",{className:"text"},s.a.createElement("div",{className:"title"},"Create Group"),s.a.createElement("div",{className:"message"},a||"Type a group name..."))))},j=(a(191),a(9)),x=a.n(j),w=function(e,t){return x()({method:"post",url:(O.url||"")+"/api/search",data:{limit:t||30,search:e||""}})},S=function(){var e=Object(o.useRef)(),t=Object(m.useGlobal)("searchResults")[1],a=Object(m.useGlobal)("nav"),n=Object(b.a)(a,2),r=n[0],c=n[1],l=Object(m.useGlobal)("search")[1];return s.a.createElement("div",{className:"search-bar uk-flex uk-flex-center uk-flex-middle"},s.a.createElement("div",{className:"icon",onClick:function(){return e.current.focus()}},s.a.createElement(g.D,null)),s.a.createElement("div",{className:"uk-inline search"},s.a.createElement("input",{className:"uk-input uk-border-pill",placeholder:"Search",ref:e,onChange:function(e){"search"!==r&&c("search"),l(e.target.value),w(e.target.value).then((function(e){return t(e.data.users)})).catch((function(e){return console.log(e)}))}})))},y=(a(208),function(e){var t=e.user,a=e.selected,n=e.onSelect,r=Object(o.useState)(!1),c=Object(b.a)(r,2),l=(c[0],c[1]),i="".concat(t.firstName," ").concat(t.lastName).substr(0,22);return s.a.createElement("div",{className:"room uk-flex",onMouseOver:function(){return l(!0)},onMouseOut:function(){return l(!1)},onClick:n},s.a.createElement("div",{className:"profile"},s.a.createElement(k,{user:t})),s.a.createElement("div",{className:"text"},s.a.createElement("div",{className:"title"},i,i.length>22&&"...")),s.a.createElement("div",{className:"controls"},s.a.createElement("div",{className:"date".concat(a?" selected":"")},"@",t.username)),s.a.createElement("div",{className:"controls"},s.a.createElement("div",{className:"button".concat(a?" selected":"")},a?s.a.createElement(g.v,null):s.a.createElement(g.C,null))))}),_=function(){var e=Object(m.useGlobal)("panel"),t=Object(b.a)(e,2),a=(t[0],t[1]),n=Object(m.useGlobal)("user")[0],r=Object(m.useGlobal)("search")[0],c=Object(m.useGlobal)("newGroupUsers"),l=Object(b.a)(c,2),i=l[0],u=l[1],d=Object(m.useGlobal)("searchResults"),f=Object(b.a)(d,2),p=f[0],v=f[1],E=Object(o.useState)(!1),g=Object(b.a)(E,2),O=g[0],k=g[1];Object(o.useEffect)((function(){w().then((function(e){return v(e.data.users)})).catch((function(e){return console.log(e)}))}),[v]),Object(o.useEffect)((function(){u([n.id])}),[n]);var j=p.map((function(e){return s.a.createElement(y,{key:e._id,user:e,selected:i.includes(e._id),onSelect:function(){return t=e._id,void(i.includes(t)?u(i.filter((function(e){return e!==t}))):(k(!1),u([].concat(Object(h.a)(i),[t]))));var t}})})),x=function(e){var t=e.text;return s.a.createElement("div",{className:"notice"},t)};return s.a.createElement("div",{className:"group-create"},s.a.createElement(N,null),s.a.createElement(S,null),s.a.createElement("button",{className:"uk-margin-remove uk-button uk-button-large uk-button-primary create-button",onClick:function(e){e.preventDefault(),i.length>1?a("createGroup2"):k(!0)}},"Select Users"),s.a.createElement("div",{className:"selection-text error",hidden:i.length<=1||!O},"You must select some people!"),s.a.createElement("div",{className:"selection-text",hidden:i.length<=1},i.length-1," selected - ",s.a.createElement("a",{onClick:function(){return u([n.id])}},"Clear")),s.a.createElement("div",{className:"rooms"},j,0===p.length&&s.a.createElement(x,{text:'There are no users available for "'.concat(r,'"')})))},C=a(4),D=a.n(C),G=a(8),I=(a(210),a(211),function(){var e=Object(m.useGlobal)("panel")[1],t=Object(m.useGlobal)("groupTitle")[0],a={title:"Group",isGroup:!0};return s.a.createElement("div",{className:"top-bar-group uk-flex uk-flex-between uk-flex-middle"},s.a.createElement("div",{className:"nav"},s.a.createElement("div",{className:"button",onClick:function(){return e("createGroup")}},s.a.createElement(g.a,null)),s.a.createElement("div",{className:"profile conversation"},s.a.createElement(k,{user:a,group:a.isGroup,picture:a.picture,title:a.title})),s.a.createElement("div",{className:"text"},s.a.createElement("div",{className:"title"},"Create Group"),s.a.createElement("div",{className:"message"},t||"Type a group name..."))))}),T=a(6),R=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},n=arguments.length>3?arguments[3]:void 0,r=(O.url||"")+"/api/upload",c=new FormData;c.append("image",e,e.name),c.append("crop",n);var l={onUploadProgress:a};return x.a.post(r,c,l)},M=function(e){return x()({method:"post",url:(O.url||"")+"/api/group/create",data:e})},A=function(e){return x()({method:"post",url:(O.url||"")+"/api/room/create",data:{counterpart:e}})},U={IO_INIT:"IO_INIT",SET_MESSAGES:"SET_MESSAGES",MORE_MESSAGES:"MORE_MESSAGES",MESSAGE:"MESSAGE",SET_ROOM:"SET_ROOM",SET_ROOMS:"SET_ROOMS",ONLINE_USERS:"ONLINE_USERS",SET_EMOJI:"SET_EMOJIS",SET_TYPING:"SET_TYPING",RTC_PRODUCER:"RTC_PRODUCER",RTC_PRODUCERS:"RTC_PRODUCERS",RTC_RESET_PRODUCERS:"RTC_RESET_PRODUCERS",RTC_LEAVE:"RTC_LEAVE",RTC_ROOM_ID:"RTC_ROOM_ID",RTC_CONSUMERS:"RTC_CONSUMERS",RTC_NEW_PEER:"RTC_NEW_PEER",RTC_CALL:"RTC_CALL",RTC_CLOSE:"RTC_CLOSE",RTC_ANSWER:"RTC_ANSWER",RTC_SET_COUNTERPART:"RTC_SET_COUNTERPART",MESSAGES_ADD_ROOM_UNREAD:"MESSAGES_ADD_ROOM_UNREAD",MESSAGES_REMOVE_ROOM_UNREAD:"MESSAGES_REMOVE_ROOM_UNREAD",REFRESH_MEETINGS:"REFRESH_MEETINGS"},P=function(){Object(T.b)();var e=Object(m.useGlobal)("panel")[1],t=(Object(m.useGlobal)("search")[0],Object(m.useGlobal)("newGroupUsers")),a=Object(b.a)(t,2),n=a[0],r=(a[1],Object(m.useGlobal)("searchResults")),c=Object(b.a)(r,2),l=(c[0],c[1],Object(o.useRef)(null)),i=Object(m.useGlobal)("groupTitle"),u=Object(b.a)(i,2),d=u[0],p=u[1],v=Object(o.useState)(!1),E=Object(b.a)(v,2),h=E[0],k=E[1],N=Object(m.useGlobal)("groupPicture"),j=Object(b.a)(N,2),x=j[0],w=j[1],S=Object(f.g)(),y=(Object(f.h)(),function(e){var t=e.picture;return t?s.a.createElement("img",{src:"".concat(O.url||"","/api/images/").concat(t.shieldedID,"/256"),alt:"Picture",className:"picture"}):s.a.createElement("div",{className:"img"},d&&d.length>0?d.substr(0,1):"G")}),_=function(){var e=Object(G.a)(D.a.mark((function e(t){var a;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R(t,null,(function(){}),"square");case 2:a=e.sent,w(a.data.image);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(){var t=Object(G.a)(D.a.mark((function t(a){var r,c,l;return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),d&&0!==d.length){t.next=3;break}return t.abrupt("return",k(!0));case 3:return k(null),t.next=6,M({people:n,picture:x,title:d});case 6:r=t.sent,c=r.data,e("standard"),l="/room/".concat(c._id),S.replace(l);case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return s.a.createElement("div",{className:"group-create"},s.a.createElement(I,null),s.a.createElement("button",{className:"uk-button uk-button-large uk-button-primary create-button",onClick:C},"Create Group"),s.a.createElement("div",{className:"selection-text error",hidden:!h},"Group name required!"),s.a.createElement("input",{className:"file-input",type:"file",ref:l,accept:"image/*",onChange:function(e){return _(e.target.files[0])}}),s.a.createElement("div",{style:{marginTop:15},className:"picture",onClick:function(){return l&&l.current&&l.current.click()}},s.a.createElement(y,{picture:x}),s.a.createElement("div",{className:"overlay"},s.a.createElement("div",{className:"text"},s.a.createElement(g.i,null)))),s.a.createElement("input",{className:"group-name",type:"text",placeholder:"Group name...",value:d,onChange:function(e){return p(e.target.value)}}))},L=(a(214),a(215),function(e){return x()({method:"post",url:(O.url||"")+"/api/meeting/get",data:e})}),z=function(){var e=Object(T.c)((function(e){return e.io.onlineUsers})),t=Object(T.c)((function(e){return e.io.io})),a=Object(m.useGlobal)("nav"),n=Object(b.a)(a,2),r=n[0],c=n[1],l=Object(m.useGlobal)("token")[1],o=Object(m.useGlobal)("panel")[1],i=Object(m.useGlobal)("over")[1],u=Object(m.useGlobal)("user"),p=Object(b.a)(u,2),v=p[0],E=p[1],h=Object(m.useGlobal)("audio")[1],N=Object(m.useGlobal)("video")[1],j=Object(m.useGlobal)("callDirection")[1],x=Object(f.g)(),w=Object(f.h)(),S=Object(d.useToasts)().addToast,y=function(){var e=Object(G.a)(D.a.mark((function e(){var a;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.disconnect(),a=v.username,localStorage.removeItem("token"),e.next=5,l(null);case 5:return e.next=7,E({});case 7:S("User ".concat(a," logged out!"),{appearance:"success",autoDismiss:!0}),x.replace("/login");case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),_=function(){var e=Object(G.a)(D.a.mark((function e(){var t;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h(!0);case 2:return e.next=4,N(!0);case 4:return e.next=6,j("meeting");case 6:return e.prev=6,e.next=9,L();case 9:t=e.sent,x.replace("/meeting/"+t.data._id),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(6),S("Server error. Unable to initiate call.",{appearance:"error",autoDismiss:!0});case 16:case"end":return e.stop()}}),e,null,[[6,13]])})));return function(){return e.apply(this,arguments)}}(),C=function(){return e.filter((function(e){return e.id===v.id&&"busy"===e.status})).length>0?"busy":e.filter((function(e){return e.id===v.id&&"online"===e.status})).length>0?"online":e.filter((function(e){return e.id===v.id&&"away"===e.status})).length>0?"away":null};return s.a.createElement("div",{className:"top-bar uk-flex uk-flex-between uk-flex-middle"},s.a.createElement("div",{className:"uk-flex uk-flex-middle"},s.a.createElement("div",{className:"profile",onClick:function(){i(!0),c("rooms"),x.replace("/")}},s.a.createElement(k,{user:v||{}})),C()&&s.a.createElement("div",{className:"dot ".concat(C())})),s.a.createElement("div",{className:"nav"},("root"===v.level||"admin"===v.level)&&s.a.createElement("div",{className:"button".concat(w.pathname.startsWith("/admin")?" active":""),onClick:function(){i(!0),x.replace("/admin")}},s.a.createElement(g.g,null)),s.a.createElement("div",{className:"button mobile",onClick:function(){i(!0),x.replace("/")}},s.a.createElement(g.l,null)),s.a.createElement("div",{className:"button",onClick:function(){return o("createGroup")}},s.a.createElement(g.C,null)),s.a.createElement("div",{className:"button".concat("settings"===r?" active":""),onClick:function(){c("settings")}},s.a.createElement(g.F,null)),s.a.createElement("div",{className:"uk-inline"},s.a.createElement("div",{className:"button",type:"button"},s.a.createElement(g.x,null)),s.a.createElement("div",{"data-uk-dropdown":"mode: click; offset: 5; boundary: .top-bar"},s.a.createElement("div",{className:"link",onClick:function(){return _()}},"New Meeting"),s.a.createElement("div",{className:"link",onClick:function(){return o("createGroup")}},"New Group"),O.demo&&s.a.createElement("div",{className:"divider"}),O.demo&&s.a.createElement("div",{className:"link",onClick:function(){return window.open("http://aoneahsan.website","_blank")}},"Aoneahsan.website ",s.a.createElement("div",{className:"icon"},s.a.createElement(g.j,null))),O.demo&&s.a.createElement("div",{className:"link",onClick:function(){return window.open("http://zaions.com","_blank")}},"Zaions.com ",s.a.createElement("div",{className:"icon"},s.a.createElement(g.j,null))),("root"===v.level||"admin"===v.level)&&s.a.createElement("div",{className:"divider"}),("root"===v.level||"admin"===v.level)&&s.a.createElement("div",{className:"link",onClick:function(){i(!0),x.replace("/admin")}},"Admin Panel"),s.a.createElement("div",{className:"divider"}),s.a.createElement("div",{className:"link",onClick:y},"Logout")))))},q=(a(216),function(){var e=Object(o.useRef)(),t=Object(m.useGlobal)("searchResults")[1],a=Object(m.useGlobal)("nav"),n=Object(b.a)(a,2),r=n[0],c=n[1],l=Object(m.useGlobal)("search")[1];return s.a.createElement("div",{className:"search-bar uk-flex uk-flex-center uk-flex-middle"},s.a.createElement("div",{className:"icon",onClick:function(){return e.current.focus()}},s.a.createElement(g.D,null)),s.a.createElement("div",{className:"uk-inline search"},s.a.createElement("input",{className:"uk-input uk-border-pill",placeholder:"Search",ref:e,onChange:function(e){"search"!==r&&c("search"),l(e.target.value),w(e.target.value).then((function(e){return t(e.data.users)})).catch((function(e){return console.log(e)}))}})))}),F=(a(217),function(){var e=Object(m.useGlobal)("nav"),t=Object(b.a)(e,2),a=t[0],n=t[1];return s.a.createElement("div",{className:"nav-bar uk-flex"},s.a.createElement("div",{className:"item".concat("rooms"===a?" active":""),onClick:function(){return n("rooms")}},s.a.createElement("div",{className:"icon"},s.a.createElement(g.q,null)),s.a.createElement("div",{className:"text"},"Rooms")),s.a.createElement("div",{className:"item".concat("search"===a?" active":""),onClick:function(){return n("search")}},s.a.createElement("div",{className:"icon"},s.a.createElement(g.D,null)),s.a.createElement("div",{className:"text"},"Search")),s.a.createElement("div",{className:"item".concat("favorites"===a?" active":""),onClick:function(){return n("favorites")}},s.a.createElement("div",{className:"icon"},s.a.createElement(g.H,null)),s.a.createElement("div",{className:"text"},"Favorites")),s.a.createElement("div",{className:"item".concat("meetings"===a?" active":""),onClick:function(){n("meetings")}},s.a.createElement("div",{className:"icon"},s.a.createElement(g.J,null)),s.a.createElement("div",{className:"text"},"Meetings")))}),W=(a(218),function(){var e=Object(m.useGlobal)("meetingID"),t=Object(b.a)(e,2),a=t[0],n=(t[1],Object(m.useGlobal)("over")),r=Object(b.a)(n,2),c=(r[0],r[1]),l=Object(m.useGlobal)("showPanel"),o=Object(b.a)(l,2),i=(o[0],o[1]),u=Object(f.g)();return s.a.createElement("div",{className:"meeting-bar uk-flex uk-flex-center uk-flex-middle",onClick:function(){i(!1),c(!0),u.replace("/meeting/"+a)}},"Go back to the meeting")}),V=a(7),J=(a(116),a(16)),Z=a.n(J),H=function(e){var t=e.roomID,a=e.meetingID;return x()({method:"post",url:(O.url||"")+"/api/meeting/call",data:{roomID:t,meetingID:a}})},B=function(e){return x()({method:"post",url:(O.url||"")+"/api/room/remove",data:{id:e}})},K=function(){return x()({method:"post",url:(O.url||"")+"/api/rooms/list",data:{limit:30}})},Y=function(e){var t=e.room,a=Object(T.c)((function(e){return e.messages.roomsWithNewMessages})),n=Object(T.c)((function(e){return e.io.onlineUsers})),r=Object(T.c)((function(e){return e.io.room})),c=Object(o.useState)(!1),l=Object(b.a)(c,2),i=l[0],u=l[1],p=Object(m.useGlobal)("user")[0],v=Object(m.useGlobal)("audio")[1],E=Object(m.useGlobal)("video")[1],h=Object(m.useGlobal)("callDirection")[1],O=Object(m.useGlobal)("meeting")[1],N=Object(f.g)(),j=Object(f.h)(),x=Object(T.b)(),w=Object(d.useToasts)().addToast,S={};t.people.forEach((function(e){p.id!==e._id&&(S=e)})),S.firstName||(S=Object(V.a)(Object(V.a)({},S),{},{firstName:"Deleted",lastName:"User"}));var y=(t.isGroup?t.title:"".concat(S.firstName," ").concat(S.lastName)).substr(0,22),_=t.lastMessage,C="";switch(!_&&t.isGroup&&(C="New group created."),_||t.isGroup||(C="No messages with ".concat(S.firstName," yet.")),_||(_={}),_.author!==p.id||t.isGroup||(C+="You: "),_.type){case"file":C+="Sent a file.";break;case"image":C+="Sent a picture.";break;default:C+=_.content||""}var I=_?Z()(_.date).format("MMM D"):"",R=_?Z()(_.date).format("h:mm A"):"",M=function(e,t){w(e,{appearance:t,autoDismiss:!0})},A=function(){var e=Object(G.a)(D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Are you sure you want to remove this room? All associated messages will be deleted, both for you and other members.")){e.next=12;break}return e.prev=1,e.next=4,B(t._id);case 4:M("Room has been deleted.","success"),K().then((function(e){return x({type:U.SET_ROOMS,rooms:e.data.rooms})})).catch((function(e){return console.log(e)})),r&&t._id===r._id&&N.replace("/"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),M("Error while removing room. Please retry!","error");case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}(),P=window.innerWidth<700,z=function(e){w(e,{appearance:"error",autoDismiss:!0})},q=function(){var e=Object(G.a)(D.a.mark((function e(a,r){var c;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==n.filter((function(e){return e.id===S._id})).length||t.isGroup){e.next=2;break}return e.abrupt("return",void w("Can't call user because user is offline",{appearance:"warning",autoDismiss:!0}));case 2:return e.next=4,v(!0);case 4:return e.next=6,E(r);case 6:return e.next=8,h("outgoing");case 8:return x({type:U.RTC_SET_COUNTERPART,counterpart:a}),e.prev=9,e.next=12,L({startedAsCall:!0,caller:p.id,callee:S._id,callToGroup:t.isGroup,group:t._id});case 12:return c=e.sent,e.next=15,O(c.data);case 15:return N.replace("/meeting/"+c.data._id),e.next=18,H({roomID:t._id,meetingID:c.data._id});case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(9),z("Server error. Unable to initiate call.");case 23:case"end":return e.stop()}}),e,null,[[9,20]])})));return function(t,a){return e.apply(this,arguments)}}(),F=function(){return t.isGroup?null:n.filter((function(e){return e.id===S._id&&"busy"===e.status})).length>0?"busy":n.filter((function(e){return e.id===S._id&&"online"===e.status})).length>0?"online":n.filter((function(e){return e.id===S._id&&"away"===e.status})).length>0?"away":null};return s.a.createElement("div",{className:"room uk-flex",onMouseOver:P?void 0:function(){return u(!0)},onMouseOut:P?void 0:function(){return u(!1)},onClick:function(){var e="/room/".concat(t._id);j.pathname!==e&&N.replace(e)}},s.a.createElement("div",{className:"uk-flex uk-flex-middle"},s.a.createElement("div",{className:"profile"},s.a.createElement(k,{user:S,group:t.isGroup,picture:t.picture,title:t.title})),F()&&s.a.createElement("div",{className:"dot ".concat(F())})),s.a.createElement("div",{className:"text"},s.a.createElement("div",{className:"title".concat(a.includes(t._id)?" highlight":"")},y.substr(0,20),y.length>20&&"...",a.includes(t._id)?" (".concat(a.filter((function(e){return t._id===e})).length,")"):""),s.a.createElement("div",{className:"message".concat(a.includes(t._id)?" highlight":"")},C.substr(0,26),C.length>26&&"...")),s.a.createElement("div",{className:"controls",hidden:i},s.a.createElement("div",{className:"date"},I,s.a.createElement("br",null),R)),s.a.createElement("div",{className:"controls",hidden:!i},s.a.createElement("div",{className:"button",onClick:function(){return q(S,!1)}},s.a.createElement(g.z,null)),s.a.createElement("div",{className:"uk-inline"},s.a.createElement("div",{className:"button",type:"button"},s.a.createElement(g.x,null)),s.a.createElement("div",{"data-uk-dropdown":"mode: click; offset: 5; boundary: .top-bar"},s.a.createElement("div",{className:"link",onClick:A},"Remove")))))},X=(a(220),function(e){var t,a=e.meeting,n=Object(m.useGlobal)("meetingID")[1],r=Object(m.useGlobal)("over"),c=Object(b.a)(r,2),l=(c[0],c[1]),o=Object(m.useGlobal)("showPanel"),i=Object(b.a)(o,2),u=(i[0],i[1]),d=Object(m.useGlobal)("user")[0],p=Object(f.g)();a.title&&a.title.length>0&&a.title;a.peers.length>0?t="".concat(a.peers.length," peers connected"):a.lastLeave&&(t="Meeting ended "+J(a.lastLeave).fromNow());var v=a.callee&&d.id===a.callee._id;return console.log(a),s.a.createElement("div",{className:"meeting-entry uk-flex uk-flex-center uk-flex-middle",onClick:function(){n(a._id),u(!1),l(!0),p.replace("/meeting/"+a._id)}},s.a.createElement("div",{className:"img-wrapper"},s.a.createElement("div",{className:"img-content".concat(a.peers.length?" active":"")},a.peers.length)),s.a.createElement("div",{className:"text"},s.a.createElement("div",{className:"title"},a.startedAsCall?a.callToGroup?"Group call in ".concat(a.group.title):v?"Call from ".concat(a.caller?a.caller.firstName:"Deleted"," ").concat(a.caller?a.caller.lastName:"User"):"Call to ".concat(a.callee?a.callee.firstName:"Deleted"," ").concat(a.callee?a.callee.lastName:"User"):"Untitled Meeting"),s.a.createElement("div",{className:"message"},t),s.a.createElement("div",{className:"message"},"ID: ",a._id)))}),$=function(e){var t=e.user,a=Object(o.useState)(!1),n=Object(b.a)(a,2),r=n[0],c=n[1],l=Object(m.useGlobal)("nav"),i=Object(b.a)(l,2),u=(i[0],i[1]),d=Object(f.g)(),p=Object(f.h)(),v=Object(T.b)(),E="".concat(t.firstName," ").concat(t.lastName).substr(0,22),h=function(){var e=Object(G.a)(D.a.mark((function e(){var a,n;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A(t._id);case 2:a=e.sent,u("rooms"),n="/room/".concat(a.data.room._id),v({type:U.SET_ROOM,room:a.data.room}),v({type:U.SET_MESSAGES,messages:a.data.room.messages}),p.pathname!==n&&d.replace(n);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return s.a.createElement("div",{className:"room uk-flex",onMouseOver:function(){return c(!0)},onMouseOut:function(){return c(!1)},onClick:h},s.a.createElement("div",{className:"profile"},s.a.createElement(k,{user:t})),s.a.createElement("div",{className:"text"},s.a.createElement("div",{className:"title"},E,E.length>22&&"...")),s.a.createElement("div",{className:"controls",hidden:r},s.a.createElement("div",{className:"date"},"@",t.username)),s.a.createElement("div",{className:"controls",hidden:!r},s.a.createElement("div",{className:"button"},s.a.createElement(g.r,null))))},Q=function(){return x()({method:"post",url:(O.url||"")+"/api/favorites/list",data:{}})},ee=function(){return x()({method:"post",url:(O.url||"")+"/api/meeting/list",data:{}})},te=(a(221),function(e){return x()({method:"post",url:(O.url||"")+"/api/picture/change",data:{imageID:e}})}),ae=function(){var e=Object(d.useToasts)().addToast,t=Object(f.g)(),a=Object(m.useGlobal)("user"),n=Object(b.a)(a,2),r=n[0],c=n[1],l=Object(m.useGlobal)("token")[1],i=Object(m.useGlobal)("panel")[1],u=Object(o.useRef)(null),p=function(){var e=Object(G.a)(D.a.mark((function e(t){var a,n;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R(t,null,(function(){}),"square");case 2:return a=e.sent,e.next=5,te(a.data.image._id);case 5:return n=Object(V.a)(Object(V.a)({},r),{},{picture:a.data.image}),localStorage.setItem("user",JSON.stringify(n)),e.next=9,c(n);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=Object(G.a)(D.a.mark((function e(){var t;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te();case 2:return t=Object(V.a)(Object(V.a)({},r),{},{picture:void 0}),localStorage.setItem("user",JSON.stringify(t)),e.next=6,c(t);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),E=function(){var a=Object(G.a)(D.a.mark((function a(){var n;return D.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=r.username,localStorage.removeItem("token"),a.next=4,l(null);case 4:return a.next=6,c({});case 6:e("User ".concat(n," logged out!"),{appearance:"success",autoDismiss:!0}),t.replace("/login");case 8:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}(),h=function(){return r.picture?s.a.createElement("img",{src:"".concat(O.url||"","/api/images/").concat(r.picture.shieldedID,"/256"),alt:"Picture",className:"picture"}):s.a.createElement("div",{className:"img"},r.firstName.substr(0,1),r.lastName.substr(0,1))};return s.a.createElement("div",{className:"settings uk-flex uk-flex-column uk-padding-small"},s.a.createElement("input",{className:"file-input",type:"file",ref:u,accept:"image/*",onChange:function(e){return p(e.target.files[0])}}),s.a.createElement("div",{className:"picture uk-margin-small",onClick:function(){return u&&u.current&&u.current.click()}},s.a.createElement(h,null),s.a.createElement("div",{className:"overlay"},s.a.createElement("div",{className:"text"},s.a.createElement(g.i,null)))),s.a.createElement("button",{className:"uk-margin-small-top uk-button uk-button-secondary",onClick:v},"Remove Picture"),s.a.createElement("button",{className:"uk-margin-small-top uk-button uk-button-secondary",onClick:E},"Logout"),s.a.createElement("button",{className:"uk-margin-small uk-button uk-button-honey uk-button-large",onClick:function(){return i("createGroup")}},"Create Group"))},ne=function(){var e=Object(m.useGlobal)("nav")[0],t=(Object(m.useGlobal)("token")[0],Object(m.useGlobal)("search")[0]),a=Object(T.c)((function(e){return e.io.rooms})),n=Object(m.useGlobal)("searchResults"),r=Object(b.a)(n,2),c=r[0],l=r[1],i=Object(m.useGlobal)("favorites"),u=Object(b.a)(i,2),d=u[0],p=u[1],v=Object(m.useGlobal)("meetings"),E=Object(b.a)(v,2),h=E[0],g=E[1],O=Object(m.useGlobal)("callStatus"),k=Object(b.a)(O,2),N=k[0],j=(k[1],Object(m.useGlobal)("over")),x=Object(b.a)(j,2),S=x[0],y=(x[1],Object(T.c)((function(e){return e.io.refreshMeetings}))),_=Object(T.b)(),C=Object(f.h)();Object(o.useEffect)((function(){K().then((function(e){return _({type:U.SET_ROOMS,rooms:e.data.rooms})})).catch((function(e){return console.log(e)})),w().then((function(e){return l(e.data.users)})).catch((function(e){return console.log(e)})),Q().then((function(e){return p(e.data.favorites)})).catch((function(e){return console.log(e)})),ee().then((function(e){return g(e.data.meetings)})).catch((function(e){return console.log(e)}))}),[l,p]),Object(o.useEffect)((function(){ee().then((function(e){return g(e.data.meetings)})).catch((function(e){return console.log(e)}))}),[y]);var D=a.map((function(e){return s.a.createElement(Y,{key:e._id,room:e})})),G=c.map((function(e){return s.a.createElement($,{key:e._id,user:e})})),I=d.map((function(e){return s.a.createElement(Y,{key:e._id,room:e})})),R=h.map((function(e){return s.a.createElement(X,{key:e._id,meeting:e})})),M=function(e){var t=e.text;return s.a.createElement("div",{className:"notice"},t)};return s.a.createElement("div",{className:"panel"},s.a.createElement(z,null),s.a.createElement(q,null),s.a.createElement(F,null),"in-call"===N&&(!C.pathname.startsWith("/meeting")||!1===S)&&s.a.createElement(W,null),s.a.createElement("div",{className:"rooms"},"rooms"===e&&D,"rooms"===e&&0===a.length&&s.a.createElement(M,{text:"There are no rooms yet. Contact someone or create a group to begin!"}),"search"===e&&G,"search"===e&&0===c.length&&s.a.createElement(M,{text:'There are no search results for "'.concat(t,'"')}),"favorites"===e&&I,"favorites"===e&&0===d.length&&s.a.createElement(M,{text:"There are no favorites yet. Add a room to your favorites!"}),"meetings"===e&&R,"meetings"===e&&0===h.length&&s.a.createElement(M,{text:"There are no meetings yet. Create a new meeting or call someone!"}),"settings"===e&&s.a.createElement(ae,null)))},re=(a(222),a(43)),ce=a.n(re),le=function(){Object(m.useGlobal)("version")[0];return s.a.createElement("div",{className:"info"},s.a.createElement("div",{className:"top"},s.a.createElement("div",{className:"logo"},s.a.createElement("img",{src:ce.a,alt:"Picture"})),s.a.createElement("div",{className:"text"},"Welcome to ",O.appName||"Chat Zaions","!",s.a.createElement("br",null),s.a.createElement("br",null),O.appName||"Chat Zaions"," is a messaging app that enables real-time messaging, audio and video calls, groups and conferencing.")),s.a.createElement("div",{className:"text"},"Copyright \xa9 ",O.brand||"Zaions.com",s.a.createElement("br",null)))},oe=(a(223),a(72)),se=function(){var e=Object(T.c)((function(e){return e.io.room})),t=Object(T.c)((function(e){return e.io.onlineUsers})),a=(Object(T.c)((function(e){return e.io.room._id})),Object(T.c)((function(e){return e.io.room.images.length}))),n=(Object(T.c)((function(e){return e.io.room.images.length>0?e.io.room.images[e.io.room.images.length-1]._id:null})),Object(m.useGlobal)("user")[0]),r=Object(o.useRef)(null),c=Object(o.useState)(0),l=Object(b.a)(c,2),i=l[0],u=l[1],d=Object(o.useState)(null),f=Object(b.a)(d,2),p=f[0],v=f[1],E=Object(o.useState)(!1),h=Object(b.a)(E,2),k=h[0],N=h[1];Object(o.useEffect)((function(){0===r.current.scrollTop&&(r.current.scrollTop=i)}),[a]);var j={firstName:"A",lastName:"A"};!e.isGroup&&e.people&&e.people.forEach((function(e){e._id!==n.id&&(j=e)}));var x=function(t){var a=t.picture,n=t.user,r=t.group;return a?s.a.createElement("img",{src:"".concat(O.url||"","/api/images/").concat(a.shieldedID,"/256"),alt:"Picture"}):s.a.createElement("div",{className:"img"},r?e.title.substr(0,1):"".concat(n.firstName.substr(0,1)).concat(n.lastName.substr(0,1)))},w=[],S=[];e.images.forEach((function(e){S.push(e),2===S.length&&(w.push(S),S=[])})),S.length>0&&w.push(S);var y=w.map((function(e){var t=e.map((function(e){return s.a.createElement("img",{src:"".concat(O.url||"","/api/images/").concat(e.content,"/256"),alt:"Sent by @".concat(e.author.username),onClick:function(){return v(e)}})}));return s.a.createElement("div",{className:"row"},t)})),_=function(){return 0===y.length?s.a.createElement("div",{className:"notice-text"},"There are no images in this conversation yet."):null},C=e.people;C.sort((function(e,t){return e.firstName<t.firstName?-1:e.firstName>t.firstName?1:e.lastName<t.lastName?-1:e.lastName>t.lastName?1:0}));var D=C.map((function(e){return s.a.createElement("div",{className:"member"},s.a.createElement(x,{picture:e.picture,user:e}),s.a.createElement("div",{className:"text"},e.firstName," ",e.lastName),s.a.createElement("div",{className:(a=e._id,t.filter((function(e){return e.id===a&&"busy"===e.status})).length>0?"busy":t.filter((function(e){return e.id===a&&"online"===e.status})).length>0?"online":t.filter((function(e){return e.id===a&&"away"===e.status})).length>0?"away":"offline")},s.a.createElement(g.e,null)));var a})),G=function(){return s.a.createElement("div",{className:"members"},D)};return s.a.createElement("div",{className:"details-room"},s.a.createElement("div",{className:"profile"},s.a.createElement(x,{group:e.isGroup,picture:e.isGroup?e.picture:j.picture,user:j})),s.a.createElement("div",{className:"name",hidden:!0},e.isGroup?e.title:"".concat(j.firstName," ").concat(j.lastName)),s.a.createElement("div",{className:"title",hidden:!0},j.tagLine||"No Tag Line"),s.a.createElement("button",{className:"details-button uk-margin-remove-bottom uk-button uk-button-secondary",onClick:function(){return N(!k)}},"View ",k?"Images":"Members"),k&&s.a.createElement(G,null),s.a.createElement("div",{className:"images",ref:r,onScroll:function(){u(r.current.scrollHeight),r.current.scrollTop,r.current.scrollHeight,r.current.offsetHeight},hidden:k},p&&s.a.createElement(oe.a,{medium:"".concat(O.url||"","/api/images/").concat(p.content,"/1024"),large:"".concat(O.url||"","/api/images/").concat(p.content,"/2048"),alt:"Lightbox",hideDownload:!0,onClose:function(){return v(null)}}),y,s.a.createElement(_,null)))},ie=(a(224),a(225),a(81),function(e){var t=e.back;return s.a.createElement("div",{className:"top-bar uk-flex uk-flex-between uk-flex-middle"},s.a.createElement("div",{className:"nav"},s.a.createElement("div",{className:"button",onClick:t},s.a.createElement(g.a,null))),s.a.createElement("div",{className:"nav"},O.demo&&s.a.createElement("div",{className:"uk-inline"},s.a.createElement("div",{className:"button",type:"button"},s.a.createElement(g.x,null)),s.a.createElement("div",{"data-uk-dropdown":"mode: click; offset: 5; boundary: .top-bar; pos: bottom-right"},s.a.createElement("div",{className:"link",onClick:function(){return window.open("http://aoneahsan.website","_blank")}},"Aoneahsan.website ",s.a.createElement("div",{className:"icon"},s.a.createElement(g.j,null))),s.a.createElement("div",{className:"link",onClick:function(){return window.open("http://zaions.com","_blank")}},"Zaions.com ",s.a.createElement("div",{className:"icon"},s.a.createElement(g.j,null)))))))}),ue=function(){var e=Object(f.h)(),t=Object(T.c)((function(e){return e.io.room})),a=Object(f.g)(),n=e.pathname.endsWith("/info");return s.a.createElement("div",{className:"details".concat(n?" expand":" uk-visible@l")},n&&s.a.createElement(ie,{back:function(){return a.replace("/room/"+t._id)}}),e.pathname.startsWith("/room")&&t||n&&t?s.a.createElement(se,null):s.a.createElement(le,null))},me=(a(226),a(60)),de=(a(227),function(e){return x()({method:"post",url:(O.url||"")+"/api/favorite/toggle",data:{roomID:e}})}),fe=function(e){var t=e.back,a=e.loading,n=Object(T.c)((function(e){return e.io.onlineUsers})),r=Object(T.c)((function(e){return e.io.room}))||{},c=Object(m.useGlobal)("user")[0],l=Object(m.useGlobal)("favorites"),i=Object(b.a)(l,2),u=i[0],p=i[1],v=Object(m.useGlobal)("nav")[1],E=Object(m.useGlobal)("audio")[1],h=Object(m.useGlobal)("video")[1],N=Object(m.useGlobal)("callDirection")[1],j=Object(m.useGlobal)("meeting")[1],x=Object(d.useToasts)().addToast,w=Object(T.b)(),S=Object(f.g)(),y={};r.people&&r.people.forEach((function(e){c.id!==e._id&&(y=e)})),y.firstName||(y=Object(V.a)(Object(V.a)({},y),{},{firstName:"Deleted",lastName:"User"}));var _=(r.isGroup?r.title:"".concat(y.firstName," ").concat(y.lastName)).substr(0,22),C=function(e){x(e,{appearance:"error",autoDismiss:!0})},I=function(){var e=Object(G.a)(D.a.mark((function e(t){var a;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==n.filter((function(e){return e.id===y._id})).length||r.isGroup){e.next=2;break}return e.abrupt("return",void x("Can't call user because user is offline",{appearance:"warning",autoDismiss:!0}));case 2:return e.next=4,E(!0);case 4:return e.next=6,h(t);case 6:return e.next=8,N("outgoing");case 8:return w({type:U.RTC_SET_COUNTERPART,counterpart:y}),e.prev=9,e.next=12,L({startedAsCall:!0,caller:c.id,callee:y._id,callToGroup:r.isGroup,group:r._id});case 12:return a=e.sent,e.next=15,j(a.data);case 15:return S.replace("/meeting/"+a.data._id),e.next=18,H({roomID:r._id,meetingID:a.data._id});case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(9),C("Server error. Unable to initiate call.");case 23:case"end":return e.stop()}}),e,null,[[9,20]])})));return function(t){return e.apply(this,arguments)}}(),R=function(){var e=Object(G.a)(D.a.mark((function e(){var t;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,de(r._id);case 2:t=e.sent,v("favorites"),p(t.data.favorites);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),M=function(e){var t=e.other,a=Object(T.c)((function(e){return e.io.onlineUsers})),n=Object(o.useRef)(!1),r=Object(o.useState)(null),c=Object(b.a)(r,2),l=c[0],s=c[1];return Object(o.useEffect)((function(){n.current&&0===a.filter((function(e){return e.id===t._id})).length&&s(Z()().valueOf()),n.current=a.filter((function(e){return e.id===t._id})).length>0}),[a,t]),a.filter((function(e){return e.id===t._id&&"busy"===e.status})).length>0?"busy":a.filter((function(e){return e.id===t._id&&"online"===e.status})).length>0?"online":a.filter((function(e){return e.id===t._id&&"away"===e.status})).length>0?"away":"Last online: ".concat(l?Z()(l).fromNow():t.lastOnline?Z()(t.lastOnline).fromNow():"Never")},A=function(){return r.isGroup?null:n.filter((function(e){return e.id===y._id&&"busy"===e.status})).length>0?"busy":n.filter((function(e){return e.id===y._id&&"online"===e.status})).length>0?"online":n.filter((function(e){return e.id===y._id&&"away"===e.status})).length>0?"away":null};return s.a.createElement("div",{className:"top-bar uk-flex uk-flex-between uk-flex-middle"},s.a.createElement("div",{className:"nav uk-flex uk-flex-middle"},s.a.createElement("div",{className:"button mobile",onClick:t},s.a.createElement(g.a,null)),!a&&s.a.createElement("div",{className:"uk-flex uk-flex-middle"},s.a.createElement("div",{className:"profile conversation"},s.a.createElement(k,{user:y,group:r.isGroup,picture:r.picture,title:r.title})),A()&&s.a.createElement("div",{className:"dot ".concat(A())})),!a&&s.a.createElement("div",{className:"text"},s.a.createElement("div",{className:"title"},_,_.length>22&&"..."),s.a.createElement("div",{className:"message"},r.isGroup?"Group: ".concat(r.people.length," members"):s.a.createElement(M,{other:y})))),s.a.createElement("div",{className:"nav"},s.a.createElement("div",{className:"button",onClick:function(){return I(!0)}},s.a.createElement(g.K,null)),s.a.createElement("div",{className:"button",onClick:function(){return I(!1)}},s.a.createElement(g.z,null)),s.a.createElement("div",{className:"button".concat(function(){var e,t=Object(me.a)(u);try{for(t.s();!(e=t.n()).done;){if(e.value._id===r._id)return!0}}catch(a){t.e(a)}finally{t.f()}return!1}()?" active":""),onClick:R},s.a.createElement(g.H,null)),s.a.createElement("div",{className:"uk-inline"},s.a.createElement("div",{className:"button",type:"button"},s.a.createElement(g.x,null)),s.a.createElement("div",{"data-uk-dropdown":"mode: click; offset: 5; boundary: .top-bar; pos: bottom-right"},s.a.createElement("div",{className:"link",onClick:function(){S.replace("/room/"+r._id+"/info")}},"Room Info ",s.a.createElement("div",{className:"icon"},s.a.createElement(g.n,null))),O.demo&&s.a.createElement("div",{className:"divider"}),O.demo&&s.a.createElement("div",{className:"link",onClick:function(){return window.open("http://aoneahsan.website","_blank")}},"Aoneahsan.website ",s.a.createElement("div",{className:"icon"},s.a.createElement(g.j,null))),O.demo&&s.a.createElement("div",{className:"link",onClick:function(){return window.open("http://zaions.com","_blank")}},"Zaions.com ",s.a.createElement("div",{className:"icon"},s.a.createElement(g.j,null)))))))},pe=(a(228),a(229),a(152)),be=function(e){return x()({method:"post",url:(O.url||"")+"/api/message",data:e})},ve=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},n=(O.url||"")+"/api/upload/file",r=new FormData;r.append("file",e,e.name);var c={onUploadProgress:a};return x.a.post(n,r,c)},Ee=function(e,t){return function(a){x.a.post("".concat(O.url||"","/api/typing"),{room:e,isTyping:t}).then((function(e){})).catch((function(e){console.log(e)}))}},he=function(){Object(m.useGlobal)("version")[0];var e=Object(o.useRef)(null),t=Object(o.useRef)(null),a=Object(m.useGlobal)("ref")[0],n=Object(T.c)((function(e){return e.io.room})),r=(Object(T.c)((function(e){return e.emoji.sheet})),Object(m.useGlobal)("user")[0]),c=Object(o.useState)(""),l=Object(b.a)(c,2),i=l[0],u=l[1],d=Object(m.useGlobal)("isPicker"),f=Object(b.a)(d,2),p=f[0],v=f[1],E=Object(o.useState)([]),O=Object(b.a)(E,2),k=O[0],N=O[1],j=Object(T.b)();Object(o.useEffect)((function(){j(Ee(n,""!==i))}),[i]);var x=function(){if(0!==i.length){be({roomID:n._id,authorID:r.id,content:i,contentType:"text"}).then((function(){K().then((function(e){return j({type:U.SET_ROOMS,rooms:e.data.rooms})})).catch((function(e){return console.log(e)}))}));var e={_id:Math.random(),author:Object(V.a)(Object(V.a)({},r),{},{_id:r.id}),content:i,type:"text",date:Z()()};j({type:U.MESSAGE,message:e}),u(""),v(!1)}},w=function(){var e=Object(G.a)(D.a.mark((function e(t){var c,l,o,s,i;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=[],l=0;case 2:if(!(l<t.length)){e.next=14;break}return o=t[l],c.push(a+l),e.next=7,R(o,a+l);case 7:s=e.sent,be({roomID:n._id,authorID:r.id,content:s.data.image.shieldedID,type:"image"}),i={_id:Math.random(),author:Object(V.a)(Object(V.a)({},r),{},{_id:r.id}),content:s.data.image.shieldedID,type:"image",date:Z()()},j({type:U.MESSAGE,message:i});case 11:l++,e.next=2;break;case 14:N([].concat(Object(h.a)(k),c)),v(!1),K().then((function(e){return j({type:U.SET_ROOMS,rooms:e.data.rooms})})).catch((function(e){return console.log(e)}));case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=Object(G.a)(D.a.mark((function e(t){var c,l,o,s,i,u;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=0;case 1:if(!(c<t.length)){e.next=7;break}if(!(t[c].size/1048576>10)){e.next=4;break}return e.abrupt("return",alert("File exceeds 10MB limit!"));case 4:c++,e.next=1;break;case 7:l=[],o=0;case 9:if(!(o<t.length)){e.next=21;break}return s=t[o],l.push(a+o),e.next=14,ve(s,a+o);case 14:i=e.sent,be({roomID:n._id,authorID:r.id,content:i.data.file.shieldedID,type:"file",fileID:i.data.file._id}),u={_id:Math.random(),author:Object(V.a)(Object(V.a)({},r),{},{_id:r.id}),content:i.data.file.shieldedID,type:"file",date:Z()(),file:i.data.file},j({type:U.MESSAGE,message:u});case 18:o++,e.next=9;break;case 21:N([].concat(Object(h.a)(k),l)),v(!1),K().then((function(e){return j({type:U.SET_ROOMS,rooms:e.data.rooms})})).catch((function(e){return console.log(e)}));case 24:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return s.a.createElement("div",{className:"bottom-bar-conversation uk-flex uk-flex-middle"},s.a.createElement("div",{className:"picker",hidden:!p},s.a.createElement(pe.a,{onSelect:function(e){return u(i+e.native)},darkMode:!1,title:"Emoji",native:!0,set:"facebook"})),s.a.createElement("div",{className:"button smile",onClick:function(){return v(!p)}},s.a.createElement(g.G,null)),s.a.createElement("input",{className:"file-input",type:"file",ref:e,accept:"image/*",multiple:!0,onChange:function(e){return w(e.target.files)}}),s.a.createElement("div",{className:"button image-attach",onClick:function(){return e&&e.current&&e.current.click()}},s.a.createElement(g.m,null)),s.a.createElement("input",{className:"file-input",type:"file",ref:t,multiple:!0,onChange:function(e){return S(e.target.files)}}),s.a.createElement("div",{className:"button attach",onClick:function(){return t&&t.current&&t.current.click()}},s.a.createElement(g.y,null)),s.a.createElement("input",{className:"search-input",type:"text",placeholder:"Type something to send...",value:i,onChange:function(e){return u(e.target.value)},"data-emoji-input":"unicode",onKeyPress:function(e){v(!1),"Enter"===e.key&&x()},onFocus:function(){return v(!1)}}),s.a.createElement("div",{className:"button",onClick:x},s.a.createElement(g.E,null)))},ge=(a(230),function(e){return x()({method:"post",url:(O.url||"")+"/api/room/join",data:{id:e}})}),Oe=a(142),ke=a.n(Oe),Ne=(a(235),a(143)),je=a.n(Ne),xe=a(153),we=a(93),Se=a.n(we),ye=function(e){var t=e.message,a=e.previous,n=e.next,r=e.onOpen,c=t.author,l=t.content,o=t.date,i=Object(m.useGlobal)("user")[0];c||(c={firstName:"Deleted",lastName:"User"}),a&&!a.author&&(a.author={firstName:"Deleted",lastName:"User"}),n&&!n.author&&(n.author={firstName:"Deleted",lastName:"User"});var u=i.id===c._id,d=!1,f=!1;a&&Math.abs(Z()(a.date).diff(Z()(o),"minutes"))<3&&c._id===a.author._id&&(d=!0),n&&Math.abs(Z()(n.date).diff(Z()(o),"minutes"))<3&&c._id===n.author._id&&(f=!0);var p=function(e){var t=e.user;return t.picture?s.a.createElement("img",{src:"".concat(O.url||"","/api/images/").concat(t.picture.shieldedID,"/256"),alt:"Picture"}):s.a.createElement("div",{className:"img"},t.firstName.substr(0,1),t.lastName.substr(0,1))},b=function(e){var t=e.side;return f?null:s.a.createElement("div",{className:"message-details ".concat(t)},Z()(o).format("MMM DD - h:mm A"))},v=function(){return d?s.a.createElement("div",{className:"spacer"}):s.a.createElement("div",{className:"picture"},s.a.createElement(p,{user:c}))},E=!l.replace(je()(),"").replace(/[\s\n]/gm,""),h=function(){switch(t.type){case"image":return s.a.createElement(xe.a,{src:"".concat(O.url||"","/api/images/").concat(t.content,"/512"),animationDuration:"0.2s",onClick:function(){return r(t)}});case"file":return s.a.createElement("a",{href:"".concat(O.url||"","/api/files/").concat(t.content),download:t.file?t.file.name:"File"},s.a.createElement("div",{className:"content-download"},s.a.createElement("div",{className:"content-file"},s.a.createElement("div",{className:"content-name"},t.file?t.file.name:"File"),s.a.createElement("div",{className:"content-size"},t.file?Math.round(t.file.size/1024/1024*10)/10+" MB":"Size")),s.a.createElement("div",{className:"content-icon"},s.a.createElement(g.h,null))));default:return s.a.createElement("div",{dangerouslySetInnerHTML:{__html:(e=Se()(l,["a","strong","b","i","em","u","br"]),e.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi,(function(e){return'<a href="'+e+'" target="_blank">'+e+"</a>"})))}})}var e};return s.a.createElement("div",{className:"message".concat(u?" right":" left").concat(d?" attach-previous":"").concat(f?" attach-next":"")},s.a.createElement(v,null),s.a.createElement("div",{className:"content-x".concat(u?" right":"").concat(d?" attach-previous":"").concat(f?" attach-next":"")},s.a.createElement("div",{className:"".concat("image"===t.type?"bubble-image":E?"emoji-bubble":"bubble").concat(d||E?u?" right":" left":u?" bubble-right right":" bubble-left left").concat(d?" attach-previous":"").concat(f?" attach-next":"")},s.a.createElement(h,null)),s.a.createElement(b,{side:u?"right":"left"})))},_e=(a(236),function(e){var t=e.roomID,a=e.firstMessageID;return x()({method:"post",url:(O.url||"")+"/api/messages/more",data:{roomID:t,firstMessageID:a}})}),Ce=function(){var e=Object(m.useGlobal)("user")[0],t=Object(T.c)((function(e){return e.io.messages}))||[],a=Object(T.c)((function(e){return e.io.room})),n=Object(o.useState)(!1),r=Object(b.a)(n,2),c=r[0],l=r[1],i=Object(T.c)((function(e){return e.messages.typing})),u=Object(T.b)(),d=Object(o.useRef)(null),f=Object(o.useState)(null),p=Object(b.a)(f,2),v=p[0],E=p[1],h={firstName:"A",lastName:"A"};!a.isGroup&&a.people&&a.people.forEach((function(t){t._id!==e.id&&(h=t)}));var g=t.map((function(e,a){return s.a.createElement(ye,{key:e._id,message:e,previous:t[a-1],next:t[a+1],onOpen:E})}));return Object(o.useEffect)((function(){d.current&&(d.current.scrollTop=d.current.scrollHeight)}),[t.length]),Object(o.useEffect)((function(){i&&d.current&&(d.current.scrollTop=d.current.scrollHeight)}),[i]),s.a.createElement("div",{className:"messages-wrapper",ref:d,onScroll:function(){if(0===d.current.scrollTop){if(c)return;l(!0),_e({roomID:a._id,firstMessageID:t[0]._id}).then((function(e){console.log(e.data.messages),u({type:U.MORE_MESSAGES,messages:e.data.messages}),l(!1)})).catch((function(e){l(!1)}))}}},s.a.createElement("div",{className:"messages-container"},v&&s.a.createElement(oe.a,{medium:"".concat(O.url||"","/api/images/").concat(v.content,"/1024"),large:"".concat(O.url||"","/api/images/").concat(v.content,"/2048"),alt:"Lightbox",hideDownload:!0,onClose:function(){return E(null)}}),g,i&&s.a.createElement("div",{className:"message left attach-previous"},s.a.createElement("div",{className:"picture"},s.a.createElement(k,{user:h})),s.a.createElement("div",{className:"content-x"},s.a.createElement("div",{className:"bubble bubble-left left",style:{width:20}},s.a.createElement("div",{id:"wave"},s.a.createElement("span",{className:"dot"}),s.a.createElement("span",{className:"dot"}),s.a.createElement("span",{className:"dot"}))),s.a.createElement("div",{className:"message-details left",style:{color:"transparent"}},"-")))))},De=function(){var e=Object(T.c)((function(e){return e.io.room})),t=Object(o.useState)(!1),a=Object(b.a)(t,2),n=a[0],r=a[1],c=Object(o.useState)(!0),l=Object(b.a)(c,2),i=l[0],u=l[1],d=Object(m.useGlobal)("over")[1],p=Object(f.i)().id,v=Object(f.g)(),E=Object(T.b)();Object(o.useEffect)((function(){u(!0),ge(p).then((function(e){E({type:U.SET_ROOM,room:e.data.room}),console.log(e.data),E({type:U.SET_MESSAGES,messages:e.data.room.messages}),u(!1),r(!1),E({type:U.MESSAGES_REMOVE_ROOM_UNREAD,roomID:p})})).catch((function(e){E({type:U.SET_ROOM,room:null}),E({type:U.SET_MESSAGES,messages:[]}),u(!1),e.response&&404===e.response.status||r(!0)}))}),[u,p]);var h=function(){return s.a.createElement("div",{className:"content uk-flex uk-flex-center uk-flex-middle uk-flex-column"},s.a.createElement(ke.a,{size:60,color:"#666",loading:i}))},g=function(){return s.a.createElement("div",{className:"content uk-flex uk-flex-center uk-flex-middle uk-flex-column"},s.a.createElement("div",{className:"notfound"},"Room Not Found"),s.a.createElement("div",{className:"notfound-extended"},"This room does not exist.",s.a.createElement("br",null),"This is probably a broken URL."))},O=function(){return s.a.createElement("div",{className:"content uk-flex uk-flex-center uk-flex-middle uk-flex-column"},s.a.createElement("div",{className:"notfound"},"Network Error"),s.a.createElement("div",{className:"notfound-extended"},"Could not reach server."))},k=function(){return s.a.createElement(Ce,null)};return s.a.createElement("div",{className:"content uk-flex uk-flex-column uk-flex-between"},s.a.createElement(fe,{back:function(){d(!1),v.replace("/")},loading:i}),i&&s.a.createElement(h,null),n&&s.a.createElement(O,null),!e&&!i&&!n&&s.a.createElement(g,null),e&&!i&&s.a.createElement(k,null),s.a.createElement(he,null))},Ge=(a(237),a(144)),Ie=(a(274),function(e){var t=e.onJoin,a=Object(m.useGlobal)("audio"),n=Object(b.a)(a,2),r=n[0],c=n[1],l=Object(m.useGlobal)("video"),i=Object(b.a)(l,2),u=i[0],d=i[1],f=Object(m.useGlobal)("audioStream"),p=Object(b.a)(f,2),v=p[0],E=p[1],h=Object(m.useGlobal)("videoStream"),O=Object(b.a)(h,2),k=O[0],N=O[1],j=Object(o.useRef)(null),x=function(){return navigator.mediaDevices.getUserMedia({audio:!0}).then((function(e){E(e)}))},w=function(){return navigator.mediaDevices.getUserMedia({video:!0}).then((function(e){N(e),j.current.srcObject=e}))};Object(o.useEffect)((function(){u&&w(),r&&x()}),[]);return s.a.createElement("div",{className:"join uk-flex uk-flex-middle uk-flex-center uk-flex-column"},s.a.createElement("img",{className:"logo-little",src:ce.a,alt:"Logo"}),s.a.createElement("p",{className:"title"},"Join Meeting"),s.a.createElement("p",{hidden:u||r},"Join as spectator."),s.a.createElement("video",{hidden:!u,className:"local-video",ref:j,onLoadedMetadata:function(){return j.current.play()},playsInline:!0}),s.a.createElement("p",{hidden:!r,style:{marginTop:u?0:20}},"Speak to test audio."),s.a.createElement("div",{className:"uk-flex"},s.a.createElement("div",{className:"controls"},r?s.a.createElement(g.s,{className:"icon"}):s.a.createElement(g.t,{className:"icon"}),s.a.createElement("label",{className:"switch"},s.a.createElement("input",{type:"checkbox",checked:r,onChange:function(e){e.target.checked?x():v.getTracks().forEach((function(e){return e.stop()})),c(e.target.checked)}}),s.a.createElement("span",{className:"slider round"}))),s.a.createElement("div",{className:"controls"},s.a.createElement("label",{className:"switch"},s.a.createElement("input",{type:"checkbox",checked:u,onChange:function(e){e.target.checked?w():k.getTracks().forEach((function(e){return e.stop()})),d(e.target.checked)}}),s.a.createElement("span",{className:"slider round"})),u?s.a.createElement(g.K,{className:"icon"}):s.a.createElement(g.L,{className:"icon"}))),s.a.createElement("button",{className:"button uk-button uk-button-primary",onClick:t},"Join"))}),Te=(a(275),a(276),function(e){var t=e.user,a=e.selected,n=e.onSelect,r=Object(o.useState)(!1),c=Object(b.a)(r,2),l=(c[0],c[1]),i="".concat(t.firstName," ").concat(t.lastName).substr(0,22);return s.a.createElement("div",{className:"room uk-flex",onMouseOver:function(){return l(!0)},onMouseOut:function(){return l(!1)},onClick:n},s.a.createElement("div",{className:"profile"},s.a.createElement(k,{user:t})),s.a.createElement("div",{className:"text"},s.a.createElement("div",{className:"title"},i,i.length>22&&"...")),s.a.createElement("div",{className:"controls"},s.a.createElement("div",{className:"date".concat(a?" selected":"")},"@",t.username)),s.a.createElement("div",{className:"controls"},s.a.createElement("div",{className:"button".concat(a?" selected":"")},a?s.a.createElement(g.A,null):s.a.createElement(g.C,null))))}),Re=function(e){var t=e.userID,a=e.meetingID;return x()({method:"post",url:(O.url||"")+"/api/meeting/add",data:{userID:t,meetingID:a}})},Me=function(e){var t=e.onClose,a=Object(o.useRef)(),n=Object(m.useGlobal)("searchResults"),r=Object(b.a)(n,2),c=r[0],l=r[1],i=Object(m.useGlobal)("search"),u=Object(b.a)(i,2),p=u[0],v=u[1],E=Object(m.useGlobal)("meeting"),O=Object(b.a)(E,2),k=(O[0],O[1],Object(o.useState)([])),N=Object(b.a)(k,2),j=N[0],x=N[1],S=Object(d.useToasts)().addToast,y=Object(f.i)().id,_=function(){var e=Object(G.a)(D.a.mark((function e(t){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x([].concat(Object(h.a)(j),[t._id])),console.warn(y),e.prev=2,e.next=5,Re({userID:t._id,meetingID:y});case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),S("Server error. Unable to initiate call.",{appearance:"error",autoDismiss:!0});case 10:case"end":return e.stop()}}),e,null,[[2,7]])})));return function(t){return e.apply(this,arguments)}}(),C=c.map((function(e){return s.a.createElement(Te,{key:e._id,user:e,onSelect:function(){return!j.includes(e._id)&&_(e)},selected:j.includes(e._id)})})),I=function(e){var t=e.text;return s.a.createElement("div",{className:"notice"},t)};return s.a.createElement("div",{className:"add-peers-overlay"},s.a.createElement("div",{className:"box"},s.a.createElement("div",{className:"top-controls"},s.a.createElement("div",{className:"title"},"Add Peers"),s.a.createElement("div",{className:"close",onClick:t},s.a.createElement(g.M,null))),s.a.createElement("div",{className:"search-bar uk-flex uk-flex-center uk-flex-middle"},s.a.createElement("div",{className:"icon",onClick:function(){return a.current.focus()}},s.a.createElement(g.D,null)),s.a.createElement("div",{className:"uk-inline search"},s.a.createElement("input",{className:"uk-input uk-border-pill",placeholder:"Search",ref:a,onChange:function(e){v(e.target.value),w(e.target.value).then((function(e){return l(e.data.users)})).catch((function(e){return console.log(e)}))}}))),s.a.createElement("div",{className:"users"},C,0===c.length&&s.a.createElement(I,{text:'There are no search results for "'.concat(p,'"')}))))},Ae=(a(277),function(e){var t=e.meetingID,a=e.userID;return x()({method:"post",url:(O.url||"")+"/api/meeting/close",data:{meetingID:t,userID:a}})}),Ue=function(e){var t=e.userID,a=e.meetingID,n=e.answer;return x()({method:"post",url:(O.url||"")+"/api/meeting/answer",data:{userID:t,meetingID:a,answer:n}})},Pe=a(145),Le=a.n(Pe),ze=function(e){e.onJoin;var t=e.incoming,a=e.meetingID,n=Object(T.c)((function(e){return e.rtc.counterpart}))||{},r=Object(m.useGlobal)("audio"),c=Object(b.a)(r,2),l=c[0],i=c[1],u=Object(m.useGlobal)("video"),p=Object(b.a)(u,2),v=p[0],E=p[1],h=Object(m.useGlobal)("audioStream"),k=Object(b.a)(h,2),N=k[0],j=k[1],x=Object(m.useGlobal)("videoStream"),w=Object(b.a)(x,2),S=w[0],y=w[1],_=Object(m.useGlobal)("accepted"),C=Object(b.a)(_,2),I=(C[0],C[1]),R=Object(T.c)((function(e){return e.rtc.callData}))||{},M=Object(o.useState)(!1),A=Object(b.a)(M,2),P=A[0],L=A[1],z=Object(T.c)((function(e){return e.rtc.closingState})),q=Object(T.c)((function(e){return e.rtc.closed})),F=Object(f.g)(),W=Object(d.useToasts)().addToast,V=Object(T.b)(),J=function(e){W(e,{appearance:"error",autoDismiss:!0})},Z=function(){var e=Object(G.a)(D.a.mark((function e(){var t;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return L(!1),e.prev=1,e.next=4,navigator.mediaDevices.getUserMedia({audio:!0});case 4:return t=e.sent,e.next=7,j(t);case 7:e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),L(!0),J("Failed to acquire audio!");case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}(),H=function(){var e=Object(G.a)(D.a.mark((function e(){var t;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return L(!1),e.prev=1,e.next=4,navigator.mediaDevices.getUserMedia({video:!0});case 4:return t=e.sent,e.next=7,y(t);case 7:e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),L(!0),J("Failed to acquire audio!");case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}();Object(o.useEffect)((function(){l&&Z(),v&&H();var e=document.createElement("audio");return e.style.display="none",e.src=Le.a,e.autoplay=!0,e.loop=!0,function(){e&&(e.pause(),e.remove())}}),[]);var B=function(e){v&&S&&S.getVideoTracks()[0].stop(),l&&N&&N.getAudioTracks()[0].stop(),V({type:U.RTC_LEAVE}),e&&Ae({meetingID:a,userID:n._id}),F.replace("/"),console.log("close action ringing")};Object(o.useEffect)((function(){z&&!q&&B(!0)}),[z,q]);var K=function(){var e=Object(G.a)(D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i(!0);case 2:return e.next=4,E(!1);case 4:return e.next=6,Z();case 6:if(!P){e.next=8;break}return e.abrupt("return");case 8:I(!0),Ue({userID:R.caller,meetingID:a});case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Y=function(){var e=Object(G.a)(D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i(!0);case 2:return e.next=4,E(!0);case 4:return e.next=6,H();case 6:if(!P){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,Z();case 10:if(!P){e.next=12;break}return e.abrupt("return");case 12:I(!0),Ue({userID:R.caller,meetingID:a});case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),X=function(){return n.firstName||(n.firstName="Anonymous"),n.lastName||(n.lastName="User"),n.picture?s.a.createElement("img",{src:"".concat(O.url||"","/api/images/").concat(n.picture.shieldedID,"/256"),alt:"Picture",className:"picture"}):s.a.createElement("div",{className:"img-wrapper"},s.a.createElement("div",{className:"img"},n.firstName.substr(0,1),n.lastName.substr(0,1)))};return s.a.createElement("div",{className:"join uk-flex uk-flex-middle uk-flex-center uk-flex-column"},s.a.createElement("img",{className:"logo-little",src:ce.a,alt:"Logo"}),s.a.createElement("p",{className:"title"},t?R.added?"Adding you to a meeting":"Incoming Call":"Outgoing Call"),s.a.createElement("p",{className:"name"},"Delta Honey"),s.a.createElement("div",{className:"picture uk-margin-small"},s.a.createElement(X,null)),s.a.createElement("div",{className:"uk-flex",hidden:!t},s.a.createElement("div",{className:"rounded-button close",onClick:B},s.a.createElement(g.B,{className:"button-icon"})),s.a.createElement("div",{className:"rounded-button",onClick:K},s.a.createElement(g.z,{className:"button-icon"})),s.a.createElement("div",{className:"rounded-button",onClick:Y},s.a.createElement(g.K,{className:"button-icon"}))),s.a.createElement("div",{className:"uk-flex",hidden:t},s.a.createElement("div",{className:"rounded-button close",onClick:B},s.a.createElement(g.B,{className:"button-icon"}))))},qe=(a(278),a(279),function(e){var t=e.audio,a=e.video,n=e.peer,r=e.isMaximized,c=e.isScreen,l=Object(o.useRef)(null),i=Object(o.useRef)(null);return Object(o.useEffect)((function(){t&&t&&(l.current.srcObject=t)}),[t]),Object(o.useEffect)((function(){a&&a&&(i.current.srcObject=a)}),[a]),s.a.createElement("div",{className:"interface uk-flex uk-flex-middle uk-flex-center uk-flex-column uk-height-1-1"},t&&s.a.createElement("audio",{ref:l,onLoadedMetadata:function(){return l.current.play()},className:"remote-audio",playsInline:!0,controls:!1,hidden:!0,"data-user":n}),a&&s.a.createElement("video",{ref:i,onLoadedMetadata:function(){return i.current.play()},className:"remote-video",playsInline:!0,controls:!1,hidden:!1,"data-user":n,style:{objectFit:!r||c?"contain":"cover"}}),!a&&s.a.createElement("div",{className:"remote-peer"},s.a.createElement("div",{className:"name"},n.firstName," ",n.lastName),s.a.createElement(k,{user:n}),s.a.createElement("div",{className:"status"},a||t?"Audio Only":"Spectator")))}),Fe=function(e){var t=e.streams,a=e.children,n=e.isMaximized,r=e.isGrid,c=Object(T.c)((function(e){return e.rtc.consumers})),l=Object(T.c)((function(e){return e.rtc.producers})),o=Object(T.c)((function(e){return e.rtc.peers})),i=Object(T.c)((function(e){return e.io.id})),u=Object(m.useGlobal)("mainStream"),d=Object(b.a)(u,2),f=d[0],p=d[1],v=c.filter((function(e){return e!==i})),E=[];if(v.forEach((function(e){var a=Object(V.a)(Object(V.a)({},o[e]),{},{video:null,audio:null,screen:null});t.filter((function(t){return t.socketID===e})).forEach((function(e){if(a.streams=[].concat(Object(h.a)(a.streams||[]),[e]),e.isVideo)return a.video=e;a.audio=e}));var n=(a.video||a.screen)&&l.filter((function(e){return e.producerID===a.video.producerID&&e.isScreen})).length>0;E.push(Object(V.a)(Object(V.a)({},a),{},{isScreen:n}))})),!r&&!f&&E.length>0&&p(E[E.length-1]),!r&&f&&E.length>0){var g=f;return E.forEach((function(e){return e.socketID===g&&(g=e)})),s.a.createElement("div",{className:"streams uk-flex uk-flex-middle uk-flex-center uk-flex-column"},s.a.createElement("div",{className:"video-container"},s.a.createElement("div",{className:"video-row"},s.a.createElement("div",{className:"video-wrapper"},s.a.createElement(qe,{isMaximized:n,video:g.video,audio:g.audio,peer:g.user,isScreen:g.isScreen})))),a)}var O=Math.ceil(Math.sqrt(E.length)),k=[],N=[];return E.forEach((function(e,t){N.length===O&&(k.push(s.a.createElement("div",{className:"video-row",key:t},N)),N=[]),console.log("peer",e),e.video&&console.log("video",e.video.getVideoTracks()[0]),N.push(s.a.createElement("div",{className:"video-wrapper",key:t},s.a.createElement(qe,{isMaximized:n,video:e.video,audio:e.audio,peer:e.user,isScreen:e.isScreen})))})),N.length>0&&k.push(s.a.createElement("div",{className:"video-row",key:"last"},N)),s.a.createElement("div",{className:"streams uk-flex uk-flex-middle uk-flex-center uk-flex-column"},0===E.length&&s.a.createElement("p",{className:"waiting"},"Waiting for others to join..."),E.length>0&&s.a.createElement("div",{className:"video-container"},k),a)},We=(a(280),a(281),function(e){var t=e.audio,a=e.video,n=e.peer,r=e.isMaximized,c=Object(o.useRef)(null),l=Object(o.useRef)(null);return Object(o.useEffect)((function(){t&&t&&(c.current.srcObject=t)}),[t]),Object(o.useEffect)((function(){a&&a&&(l.current.srcObject=a)}),[a]),s.a.createElement("div",{className:"little-interface uk-flex uk-flex-middle uk-flex-center uk-flex-column uk-height-1-1"},t&&s.a.createElement("audio",{ref:c,onLoadedMetadata:function(){return c.current.play()},className:"remote-audio",playsInline:!0,controls:!1,hidden:!0,"data-user":n}),a&&s.a.createElement("video",{ref:l,onLoadedMetadata:function(){return l.current.play()},className:"remote-video",playsInline:!0,controls:!1,hidden:!1,"data-user":n,style:{objectFit:r?"cover":"contain"}}),!a&&s.a.createElement("div",{className:"remote-peer"},s.a.createElement("div",{className:"name"},n.firstName," ",n.lastName),s.a.createElement(k,{user:n}),s.a.createElement("div",{className:"status"},a||t?"Audio Only":"Spectator")))}),Ve=function(e){var t=e.streams,a=Object(T.c)((function(e){return e.rtc.consumers})),n=Object(T.c)((function(e){return e.rtc.peers})),r=Object(T.c)((function(e){return e.io.id})),c=Object(m.useGlobal)("mainStream"),l=Object(b.a)(c,2),i=l[0],u=l[1],d=Object(o.useRef)(null);Object(o.useEffect)((function(){if(d){var e=function(e){e=window.event||e;var t=Math.max(-1,Math.min(1,e.wheelDelta||-e.detail));d.current.scrollLeft-=40*t,e.preventDefault()};return d.current.addEventListener&&(d.current.addEventListener("mousewheel",e,!1),d.current.addEventListener("DOMMouseScroll",e,!1)),function(){d.current.addEventListener&&(d.current.removeEventListener("mousewheel",e,!1),d.current.removeEventListener("DOMMouseScroll",e,!1))}}}),[d]);var f=a.filter((function(e){return e!==r})),p=[];f.forEach((function(e){var a=Object(V.a)(Object(V.a)({},n[e]),{},{video:null,audio:null,screen:null});t.filter((function(t){return t.socketID===e})).forEach((function(e){if(a.streams=[].concat(Object(h.a)(a.streams||[]),[e]),e.isVideo)return a.video=e;a.audio=e})),p.push(a)}));var v=[];return p.forEach((function(e,t){v.push(s.a.createElement("div",{className:"video".concat(i&&i.socketID===e.socketID?" main-peer":""),key:t,onClick:function(){return u(e)}},s.a.createElement(We,{isMaximized:!0,video:e.video,audio:e.audio,peer:e.user})))})),s.a.createElement("div",{className:"videos",ref:d},p.length>0&&v)},Je=function(){var e=Object(o.useState)(null),t=Object(b.a)(e,2),a=t[0],i=t[1],u=Object(T.c)((function(e){return e.io.io})),p=Object(T.c)((function(e){return e.rtc.producers})),v=Object(T.c)((function(e){return e.rtc.lastLeave})),E=Object(T.c)((function(e){return e.rtc.lastLeaveType})),O=Object(T.c)((function(e){return e.rtc.increment})),k=Object(T.c)((function(e){return e.rtc.closingState})),N=(Object(T.c)((function(e){return e.rtc.closed})),Object(m.useGlobal)("streams")),j=Object(b.a)(N,2),x=j[0],w=j[1],S=Object(m.useGlobal)("localStream"),y=Object(b.a)(S,2),_=y[0],C=y[1],I=Object(m.useGlobal)("video"),R=Object(b.a)(I,2),M=R[0],A=R[1],P=Object(m.useGlobal)("audio"),L=Object(b.a)(P,2),z=L[0],q=L[1],F=Object(m.useGlobal)("screen"),W=Object(b.a)(F,2),V=W[0],J=W[1],Z=Object(m.useGlobal)("audioStream"),H=Object(b.a)(Z,2),B=H[0],K=H[1],Y=Object(m.useGlobal)("videoStream"),X=Object(b.a)(Y,2),$=X[0],Q=X[1],ee=Object(m.useGlobal)("screenStream"),te=Object(b.a)(ee,2),ae=(te[0],te[1]),ne=Object(m.useGlobal)("callStatus"),re=Object(b.a)(ne,2),ce=re[0],le=re[1],oe=Object(m.useGlobal)("callDirection")[0],se=Object(m.useGlobal)("joined"),ie=Object(b.a)(se,2),ue=ie[0],de=ie[1],fe=Object(o.useState)(!0),pe=Object(b.a)(fe,2),be=pe[0],ve=pe[1],Ee=Object(o.useState)(!0),he=Object(b.a)(Ee,2),ge=he[0],Oe=he[1],ke=Object(o.useState)(!0),Ne=Object(b.a)(ke,2),je=Ne[0],xe=Ne[1],we=Object(m.useGlobal)("screensharing"),Se=Object(b.a)(we,2),ye=(Se[0],Se[1],Object(m.useGlobal)("accepted")),_e=Object(b.a)(ye,2),Ce=_e[0],De=_e[1],Te=Object(m.useGlobal)("showPanel"),Re=Object(b.a)(Te,2),Ue=Re[0],Pe=Re[1],Le=Object(m.useGlobal)("over"),qe=Object(b.a)(Le,2),We=(qe[0],qe[1]),Je=Object(m.useGlobal)("meetingID"),Ze=Object(b.a)(Je,2),He=(Ze[0],Ze[1]),Be=Object(o.useState)(!1),Ke=Object(b.a)(Be,2),Ye=Ke[0],Xe=Ke[1],$e=Object(T.c)((function(e){return e.rtc.counterpart}))||{},Qe=Object(T.c)((function(e){return e.rtc.answerIncrement})),et=Object(T.c)((function(e){return e.rtc.answerData})),tt=Object(f.i)().id,at=Object(T.b)(),nt=Object(f.g)();Object(d.useToasts)().addToast;Object(o.useEffect)((function(){et&&"outgoing"===oe&&"in-call"!==ce&&et.meetingID===tt&&(de(!0),ft())}),[Qe,et]),Object(o.useEffect)((function(){Ce&&De(!1).then((function(){de(!0),ft()}))}),[Ce]),Object(o.useEffect)((function(){return He(tt),function(){if("in-call"!==Object(m.getGlobal)().callStatus){try{Object(m.getGlobal)().audioStream&&Object(m.getGlobal)().audioStream.getTracks().forEach((function(e){return e.stop()}))}catch(e){}try{Object(m.getGlobal)().videoStream&&Object(m.getGlobal)().videoStream.getTracks().forEach((function(e){return e.stop()}))}catch(e){}}}}),[]);var rt=function(){var e=Object(G.a)(D.a.mark((function e(){var t;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({audio:!0});case 2:return t=e.sent,K(t),e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ct=function(){var e=Object(G.a)(D.a.mark((function e(){var t;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=navigator.mediaDevices.getUserMedia({video:!0}),Q(t),e.abrupt("return",t);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),lt=function(){var e=Object(G.a)(D.a.mark((function e(){var t;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getDisplayMedia({video:!0});case 2:return t=e.sent,ae(t),e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ot=function(){var e=Object(G.a)(D.a.mark((function e(t){var a,r,c;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t||B,q(!0),e.prev=2,r=a.getAudioTracks()[0],c={track:r},e.next=7,n.produce(c);case 7:l=e.sent,e.next=14;break;case 10:e.prev=10,e.t0=e.catch(2),console.log("getusermedia produce failed",e.t0),q(!1);case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}(),st=function(){var e=Object(G.a)(D.a.mark((function e(t){var a,c,l;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t||$,A(!0),e.prev=2,c=a.getVideoTracks()[0],l={track:c,appData:{isScreen:!1}},e.next=7,C(a);case 7:return e.next=9,n.produce(l);case 9:r=e.sent,e.next=16;break;case 12:e.prev=12,e.t0=e.catch(2),console.log("getusermedia produce failed",e.t0),A(!1);case 16:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(t){return e.apply(this,arguments)}}(),it=function(){var e=Object(G.a)(D.a.mark((function e(t){var a,r;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=t.getVideoTracks()[0],r={track:a,appData:{isScreen:!0}},e.next=5,C(t);case 5:return e.next=7,n.produce(r);case 7:return c=e.sent,e.next=10,J(!0);case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log("getusermedia produce failed",e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),ut=function(){var e=Object(G.a)(D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,_&&_.getVideoTracks()[0].stop(),e.next=4,u.request("remove",{producerID:c.id,roomID:tt});case 4:return c.close(),c=null,e.next=8,J(!1);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),mt=function(){var e=Object(G.a)(D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,_&&_.getVideoTracks()[0].stop(),e.next=4,u.request("remove",{producerID:r.id,roomID:tt});case 4:return r.close(),r=null,e.next=8,A(!1);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),dt=function(){var e=Object(G.a)(D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u.request("remove",{producerID:l.id,roomID:tt});case 3:return l.close(),l=null,e.next=7,q(!1);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),ft=function(){var e=Object(G.a)(D.a.mark((function e(){var t,a,r,c,l,o,s;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le("in-call");case 2:return e.next=4,Pe(!1);case 4:return e.next=6,We(!0);case 6:return window.consumers=[],e.next=9,w([]);case 9:return at({type:U.RTC_ROOM_ID,roomID:tt}),e.next=12,u.request("join",{roomID:tt});case 12:return t=e.sent,a=t.producers,r=t.consumers,c=t.peers,at({type:U.RTC_CONSUMERS,consumers:r,peers:c}),e.next=19,u.request("getRouterRtpCapabilities");case 19:return l=e.sent,o=new Ge.Device,e.next=23,o.load({routerRtpCapabilities:l});case 23:return i(o),e.next=26,bt(o);case 26:return at({type:U.RTC_PRODUCERS,producers:a||[]}),e.next=29,u.request("createProducerTransport",{forceTcp:!1,rtpCapabilities:o.rtpCapabilities,roomID:tt});case 29:if(!(s=e.sent).error){e.next=33;break}return console.error(s.error),e.abrupt("return");case 33:return(n=o.createSendTransport(s)).on("connect",function(){var e=Object(G.a)(D.a.mark((function e(t,a,n){var r;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.dtlsParameters,u.request("connectProducerTransport",{dtlsParameters:r}).then(a).catch(n);case 2:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}()),n.on("produce",function(){var e=Object(G.a)(D.a.mark((function e(t,a,r){var c,l,o,s,i;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t.kind,l=t.rtpParameters,o=t.appData,e.prev=1,e.next=4,u.request("produce",{transportId:n.id,kind:c,rtpParameters:l,roomID:tt,isScreen:o&&o.isScreen});case 4:s=e.sent,i=s.id,a({id:i}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),r(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,a,n){return e.apply(this,arguments)}}()),n.on("connectionstatechange",(function(e){switch(e){case"connecting":case"connected":break;case"failed":n.close()}})),e.next=39,ot();case 39:return e.next=41,st();case 41:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(o.useEffect)((function(){w("leave"===E?Object(m.getGlobal)().streams.filter((function(e){return e.socketID!==v})):Object(m.getGlobal)().streams.filter((function(e){return e.producerID!==v})))}),[v,E,w,O]),Object(o.useEffect)((function(){(function(){var e=Object(G.a)(D.a.mark((function e(){var t,a,n,r,c;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:!window.consumers&&(window.consumers=[]),t=[],a=Object(me.a)(p),e.prev=3,a.s();case 5:if((n=a.n()).done){e.next=19;break}if(r=n.value,window.consumers.includes(r.producerID)||r.roomID!==tt){e.next=17;break}return window.consumers.push(r.producerID),e.next=11,pt(window.transport,r);case 11:(c=e.sent).producerID=r.producerID,c.socketID=r.socketID,c.userID=r.userID,t.push(c),u.request("resume",{producerID:r.producerID,meetingID:tt});case 17:e.next=5;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(3),a.e(e.t0);case 24:return e.prev=24,a.f(),e.finish(24);case 27:w([].concat(Object(h.a)(Object(m.getGlobal)().streams),t));case 28:case"end":return e.stop()}}),e,null,[[3,21,24,27]])})));return function(){return e.apply(this,arguments)}})()()}),[p]);var pt=function(){var e=Object(G.a)(D.a.mark((function e(t,n){var r,c,l,o,s,i,m,d,f;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.rtpCapabilities,e.next=3,u.request("consume",{rtpCapabilities:r,socketID:n.socketID,roomID:tt,producerID:n.producerID});case 3:return c=e.sent,l=c.producerId,o=c.id,s=c.kind,i=c.rtpParameters,m={},e.next=8,t.consume({id:o,producerId:l,kind:s,rtpParameters:i,codecOptions:m});case 8:return(d=e.sent).on("producerclose",(function(){console.log("associated producer closed so consumer closed")})),d.on("close",(function(){console.log("consumer closed")})),(f=new MediaStream).addTrack(d.track),f.isVideo="video"===s,e.abrupt("return",f);case 15:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),bt=function(){var e=Object(G.a)(D.a.mark((function e(t,a){var n,r;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.request("createConsumerTransport",{forceTcp:!1,roomID:tt,socketID:a});case 2:if(!(n=e.sent).error){e.next=6;break}return console.error(n.error),e.abrupt("return");case 6:(r=t.createRecvTransport(n)).on("connect",(function(e,t,n){var c=e.dtlsParameters;u.request("connectConsumerTransport",{transportId:r.id,dtlsParameters:c,socketID:a}).then(t).catch(n)})),r.on("connectionstatechange",function(){var e=Object(G.a)(D.a.mark((function e(t){var a,n,c;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next="connecting"===e.t0?3:"connected"===e.t0?4:"failed"===e.t0?22:24;break;case 3:return e.abrupt("break",25);case 4:a=Object(me.a)(p),e.prev=5,a.s();case 7:if((n=a.n()).done){e.next=13;break}return c=n.value,e.next=11,u.request("resume",{producerID:c.producerID});case 11:e.next=7;break;case 13:e.next=18;break;case 15:e.prev=15,e.t1=e.catch(5),a.e(e.t1);case 18:return e.prev=18,a.f(),e.finish(18);case 21:return e.abrupt("break",25);case 22:return r.close(),e.abrupt("break",25);case 24:return e.abrupt("break",25);case 25:case"end":return e.stop()}}),e,null,[[5,15,18,21]])})));return function(t){return e.apply(this,arguments)}}()),window.transport=r;case 10:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),vt=function(){var e=Object(G.a)(D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{_.getVideoTracks()[0].stop()}catch(t){}return e.next=3,w([]);case 3:try{n.close()}catch(t){}return e.prev=4,e.next=7,u.request("leave",{roomID:tt});case 7:e.next=11;break;case 9:e.prev=9,e.t0=e.catch(4);case 11:return Ae({roomID:tt,userID:$e._id}),nt.replace("/"),e.next=15,de(!1);case 15:return e.next=17,Pe(!0);case 17:return e.next=19,le(null);case 19:at({type:U.RTC_LEAVE}),console.log("close action meeting");case 21:case"end":return e.stop()}}),e,null,[[4,9]])})));return function(){return e.apply(this,arguments)}}();if(Object(o.useEffect)((function(){k&&ue&&vt()}),[k]),"incoming"===oe&&!ue)return s.a.createElement("div",{className:"content uk-flex uk-flex-column uk-flex-center uk-flex-middle",style:{background:"black"}},s.a.createElement(ze,{incoming:!0,meetingID:tt,onJoin:function(){de(!0),ft()}}));if("outgoing"===oe&&!ue)return s.a.createElement("div",{className:"content uk-flex uk-flex-column uk-flex-center uk-flex-middle",style:{background:"black"}},s.a.createElement(ze,{incoming:!1,meetingID:tt}));if(!ue)return s.a.createElement("div",{className:"content uk-flex uk-flex-column uk-flex-center uk-flex-middle",style:{background:"black"}},s.a.createElement(Ie,{onJoin:function(){de(!0),ft()}}));var Et=function(e){var t=e.localStream,a=Object(o.useRef)(null);return Object(o.useEffect)((function(){t&&(a.current.srcObject=t)}),[t]),s.a.createElement("div",{className:"meeting-top-controls"},s.a.createElement("div",{className:"panel-control",onClick:function(){Pe(!Ue),We(Ue)}},Ue?s.a.createElement(g.c,null):s.a.createElement(g.p,null)),s.a.createElement(Ve,{streams:x}),s.a.createElement("div",{className:"videos",style:{flexGrow:0}},s.a.createElement("video",{hidden:!M&&!V,className:"video",onLoadedMetadata:function(){return a.current.play()},ref:a,style:{objectFit:"cover",background:"black",zIndex:1e3},playsInline:!0})),s.a.createElement("div",{className:"panel-control",onClick:function(){return xe(!je)}},je?s.a.createElement(g.b,null):s.a.createElement(g.d,null)))},ht=function(e){var t=e.localStream,a=Object(o.useRef)(null);return Object(o.useEffect)((function(){a&&(a.current.srcObject=t)}),[a]),s.a.createElement("div",{className:"meeting-top-controls-transparent"},s.a.createElement("div",{className:"panel-control",onClick:function(){Pe(!Ue),We(Ue)}},Ue?s.a.createElement(g.c,null):s.a.createElement(g.p,null)),s.a.createElement("div",{className:"videos",style:{flexGrow:0,minWidth:M||V?137:0}},s.a.createElement("video",{hidden:!M&&!V,className:"video",onLoadedMetadata:function(){return a.current.play()},ref:a,style:{objectFit:"cover",background:"black",zIndex:1e3},playsInline:!0})))};return s.a.createElement("div",{className:"meeting-main uk-flex uk-flex-column"},ge&&s.a.createElement(ht,{localStream:_}),!ge&&je&&s.a.createElement(Et,{localStream:_}),s.a.createElement(Fe,{isGrid:ge,streams:x,localStream:_,isVideo:M,isScreen:V,isMaximized:be},s.a.createElement("div",{className:"meeting-controls",style:{bottom:je||ge?0:95}},s.a.createElement("div",{className:"control",onClick:function(){return M?mt():ct().then((function(e){return st(e)}))}},M?s.a.createElement(g.K,null):s.a.createElement(g.L,null)),s.a.createElement("div",{className:"control",onClick:function(){return z?dt():rt().then((function(e){return ot(e)}))}},z?s.a.createElement(g.s,null):s.a.createElement(g.t,null)),s.a.createElement("div",{className:"control",onClick:function(){return V?ut():lt().then((function(e){return it(e)}))}},V?s.a.createElement(g.N,null):s.a.createElement(g.w,null)),s.a.createElement("div",{className:"close",onClick:vt},s.a.createElement(g.B,null)),s.a.createElement("div",{className:"control",onClick:function(){return Xe(!0)}},s.a.createElement(g.I,null)),s.a.createElement("div",{className:"control",onClick:function(){return ve(!be)}},be?s.a.createElement(g.o,null):s.a.createElement(g.u,null)),s.a.createElement("div",{className:"control",onClick:function(){return Oe(!ge)}},ge?s.a.createElement(g.k,null):s.a.createElement(g.f,null)))),!ge&&!je&&s.a.createElement(Et,{localStream:_}),Ye&&s.a.createElement(Me,{onClose:function(){return Xe(!1)}}))},Ze=(a(282),function(e){var t=e.back;return s.a.createElement("div",{className:"top-bar uk-flex uk-flex-between uk-flex-middle"},s.a.createElement("div",{className:"nav"},s.a.createElement("div",{className:"button mobile",onClick:t},s.a.createElement(g.a,null))),s.a.createElement("div",{className:"nav"},O.demo&&s.a.createElement("div",{className:"uk-inline"},s.a.createElement("div",{className:"button",type:"button"},s.a.createElement(g.x,null)),s.a.createElement("div",{"data-uk-dropdown":"mode: click; offset: 5; boundary: .top-bar; pos: bottom-right"},s.a.createElement("div",{className:"link",onClick:function(){return window.open("http://aoneahsan.website","_blank")}},"Aoneahsan.website ",s.a.createElement("div",{className:"icon"},s.a.createElement(g.j,null))),s.a.createElement("div",{className:"link",onClick:function(){return window.open("http://zaions.com","_blank")}},"Zaions.com ",s.a.createElement("div",{className:"icon"},s.a.createElement(g.j,null)))))))}),He=(a(283),function(){Object(m.useGlobal)("version")[0];return s.a.createElement("div",{className:"bottom-bar uk-flex uk-flex-between uk-flex-middle"},s.a.createElement("div",{className:"profile"}),s.a.createElement("div",{className:"nav"},s.a.createElement("div",{className:"button"},O.appName,"  - ",s.a.createElement("a",{href:"http://www.zaions.com",target:"_blank"},O.brand))))}),Be=function(){var e=Object(m.useGlobal)("user")[0],t=Object(m.useGlobal)("over")[1];return s.a.createElement("div",{className:"content uk-flex uk-flex-column"},s.a.createElement(Ze,{back:function(){return t(!1)}}),s.a.createElement("div",{className:"content uk-flex uk-flex-center uk-flex-middle uk-flex-column"},s.a.createElement("div",{className:"welcome uk-flex uk-flex-bottom"},e.firstName," ",e.lastName),s.a.createElement("div",{className:"profile"},s.a.createElement(k,{user:e})),s.a.createElement("div",{className:"tutorial uk-flex uk-flex-top uk-flex-column uk-flex-center uk-flex-middle"},"Search for someone to start a conversation,",s.a.createElement("br",null),"Add contacts to your favorites to reach them faster")),s.a.createElement(He,null))},Ke=(a(284),function(e){var t=e.back;return s.a.createElement("div",{className:"top-bar uk-flex uk-flex-between uk-flex-middle"},s.a.createElement("div",{className:"nav"},s.a.createElement("div",{className:"button mobile",onClick:t},s.a.createElement(g.a,null))),s.a.createElement("div",{className:"nav"},O.demo&&s.a.createElement("div",{className:"uk-inline"},s.a.createElement("div",{className:"button",type:"button"},s.a.createElement(g.x,null)),s.a.createElement("div",{"data-uk-dropdown":"mode: click; offset: 5; boundary: .top-bar; pos: bottom-right"},s.a.createElement("div",{className:"link",onClick:function(){return window.open("http://aoneahsan.website","_blank")}},"Aoneahsan.website ",s.a.createElement("div",{className:"icon"},s.a.createElement(g.j,null))),s.a.createElement("div",{className:"link",onClick:function(){return window.open("http://zaions.com","_blank")}},"Zaions.com ",s.a.createElement("div",{className:"icon"},s.a.createElement(g.j,null)))))))}),Ye=(a(285),function(){Object(m.useGlobal)("version")[0];return s.a.createElement("div",{className:"bottom-bar uk-flex uk-flex-between uk-flex-middle"},s.a.createElement("div",{className:"profile"}),s.a.createElement("div",{className:"nav"},s.a.createElement("div",{className:"button"},O.appName,"  - ",s.a.createElement("a",{href:"http://www.zaions.com",target:"_blank"},O.brand))))}),Xe=(a(286),function(){Object(m.useGlobal)("user")[0];var e=Object(m.useGlobal)("over")[1];return s.a.createElement("div",{className:"content uk-flex uk-flex-column"},s.a.createElement(Ke,{back:function(){return e(!1)}}),s.a.createElement("div",{className:"content uk-flex uk-flex-center uk-flex-middle uk-flex-column"},s.a.createElement("div",{className:"notfound"},"404"),s.a.createElement("div",{className:"notfound-extended"},"This page does not exist.",s.a.createElement("br",null),"There is just an empty void here.")),s.a.createElement(Ye,null))}),$e=(a(287),function(e){var t=e.back;return s.a.createElement("div",{className:"top-bar uk-flex uk-flex-between uk-flex-middle"},s.a.createElement("div",{className:"nav"},s.a.createElement("div",{className:"button mobile",onClick:t},s.a.createElement(g.a,null))),s.a.createElement("div",{className:"nav"},s.a.createElement("div",{className:"uk-inline"},s.a.createElement("div",{className:"button",type:"button"},s.a.createElement(g.x,null)),s.a.createElement("div",{"data-uk-dropdown":"mode: click; offset: 5; boundary: .top-bar"},s.a.createElement("div",{className:"link",onClick:function(){return window.open("http://aoneahsan.website","_blank")}},"Aoneahsan.website ",s.a.createElement("div",{className:"icon"},s.a.createElement(g.j,null))),s.a.createElement("div",{className:"link",onClick:function(){return window.open("http://zaions.com","_blank")}},"Zaions.com ",s.a.createElement("div",{className:"icon"},s.a.createElement(g.j,null)))))))}),Qe=(a(288),function(){Object(m.useGlobal)("version")[0];return s.a.createElement("div",{className:"bottom-bar uk-flex uk-flex-between uk-flex-middle"},s.a.createElement("div",{className:"profile"}),s.a.createElement("div",{className:"nav"},s.a.createElement("div",{className:"button"},O.appName,"  - ",s.a.createElement("a",{href:"http://www.zaions.com",target:"_blank"},O.brand))))}),et=(a(289),a(146)),tt=a.n(et),at=(a(291),function(e){var t=e.icon,a=e.placeholder,n=e.type,r=e.onChange,c=e.required,l=e.value;return s.a.createElement("div",{className:"uk-margin-small-top"},s.a.createElement("div",{className:"uk-inline uk-width-1-1"},s.a.createElement("span",{className:"uk-form-icon uk-form-icon-flip","data-uk-icon":"icon: ".concat(t),onChange:r}),s.a.createElement("input",{className:"uk-input uk-margin-remove",required:c,placeholder:a,value:l,type:n,onChange:r})))}),nt=function(e){var t=e.onClose,a=e.type,n=e.user,r=Object(d.useToasts)().addToast,c=Object(o.useState)(n?n.firstName:""),l=Object(b.a)(c,2),i=l[0],u=l[1],m=Object(o.useState)(n?n.lastName:""),f=Object(b.a)(m,2),p=f[0],v=f[1],E=Object(o.useState)(n?n.email:""),h=Object(b.a)(E,2),k=h[0],N=h[1],j=Object(o.useState)(n?n.username:""),w=Object(b.a)(j,2),S=w[0],y=w[1],_=Object(o.useState)(""),C=Object(b.a)(_,2),I=C[0],T=C[1],R=Object(o.useState)(""),M=Object(b.a)(R,2),A=M[0],U=M[1],P=Object(o.useState)(null),L=Object(b.a)(P,2),z=L[0],q=L[1],F=function(e){r(e,{appearance:"success",autoDismiss:!0})},W=function(e){r(e,{appearance:"error",autoDismiss:!0})},V=function(){var e=Object(G.a)(D.a.mark((function e(a){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.prev=1,e.next=4,n={username:S,email:k,password:I,repeatPassword:A,firstName:i,lastName:p},x()({method:"post",url:(O.url||"")+"/api/register",data:n});case 4:F("User ".concat(S," has been created")),t(!0),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),e.t0&&e.t0.response&&q(e.t0.response.data),W("Failed to create user "+S);case 12:case"end":return e.stop()}var n}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),J=function(){var e=Object(G.a)(D.a.mark((function e(a){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.prev=1,e.next=4,r={username:S,email:k,password:I,repeatPassword:A,firstName:i,lastName:p,user:n},x()({method:"post",url:(O.url||"")+"/api/user/edit",data:r});case 4:F("User ".concat(S," has been edited")),t(!0),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),e.t0&&e.t0.response&&q(e.t0.response.data),W("Failed to edit user "+S);case 12:case"end":return e.stop()}var r}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),Z=function(){var e=Object(G.a)(D.a.mark((function e(a,n){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r={email:a,username:n},x()({method:"post",url:(O.url||"")+"/api/user/delete",data:r});case 3:F("User ".concat(n," has been deleted")),t(!0),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),W("Failed to delete user "+n);case 10:case"end":return e.stop()}var r}),e,null,[[0,7]])})));return function(t,a){return e.apply(this,arguments)}}();return s.a.createElement("div",{className:"admin-overlay"},s.a.createElement("div",{className:"box"},s.a.createElement("div",{className:"top-controls"},s.a.createElement("div",{className:"title"},function(){switch(a){case"create":return"Create user";case"edit":return"Edit "+n.username.substr(0,16)+(n.username.length>16?"...":"");default:return"Delete "+n.username.substr(0,16)+(n.username.length>16?"...":"")}}()),s.a.createElement("div",{className:"close",onClick:t},s.a.createElement(g.M,null))),s.a.createElement("div",{className:"data-editor",hidden:!["create","edit"].includes(a)},s.a.createElement("div",{className:"uk-flex uk-flex-column uk-flex-center uk-flex-middle admin-delete"},s.a.createElement("form",{className:"uk-flex uk-flex-column uk-flex-center uk-flex-middle",onSubmit:function(e){return"edit"===a?J(e):V(e)}},s.a.createElement(at,{icon:"user",placeholder:"Username",type:"text",required:!0,value:S,onChange:function(e){return y(e.target.value)}}),z&&z.username&&s.a.createElement("div",{className:"admin-form-error"},z.username),s.a.createElement(at,{icon:"mail",placeholder:"Email",type:"email",required:!0,value:k,onChange:function(e){return N(e.target.value)}}),z&&z.email&&s.a.createElement("div",{className:"admin-form-error"},z.email),s.a.createElement(at,{icon:"pencil",placeholder:"First Name",type:"text",required:!0,value:i,onChange:function(e){return u(e.target.value)}}),z&&z.firstName&&s.a.createElement("div",{className:"admin-form-error"},z.firstName),s.a.createElement(at,{icon:"pencil",placeholder:"Last Name",type:"text",required:!0,value:p,onChange:function(e){return v(e.target.value)}}),z&&z.lastName&&s.a.createElement("div",{className:"admin-form-error"},z.lastName),s.a.createElement(at,{icon:"lock",placeholder:"Password",type:"password",required:"create"===a,value:I,onChange:function(e){return T(e.target.value)}}),z&&z.password&&s.a.createElement("div",{className:"admin-form-error"},z.password),s.a.createElement(at,{icon:"lock",placeholder:"Repeat Password",type:"password",required:"create"===a,value:A,onChange:function(e){return U(e.target.value)}}),z&&z.repeatPassword&&s.a.createElement("div",{className:"admin-form-error"},z.repeatPassword),s.a.createElement("button",{type:"submit",style:{marginBottom:4},className:"uk-button uk-button-honey uk-margin-top"},"edit"===a?"Update":"Create"," User"),s.a.createElement("button",{className:"uk-button uk-button-secondary",onClick:t},"Cancel"),"edit"===a&&s.a.createElement("div",{className:"uk-text-center notice"},"Leave password blank if you don't want to change it.")),s.a.createElement("div",{className:"padding"}))),s.a.createElement("div",{className:"data-editor",hidden:"delete"!==a},s.a.createElement("div",{className:"uk-flex uk-flex-column uk-flex-center uk-flex-middle admin-delete"},s.a.createElement("div",{className:"uk-text-center"},"Are you sure you want to delete user @",n&&n.username,"?"),s.a.createElement("button",{className:"uk-button uk-button-honey uk-margin-top",style:{marginBottom:4},onClick:function(){return Z(n.email,n.username)}},"Delete User"),s.a.createElement("button",{className:"uk-button uk-button-secondary",onClick:t},"Cancel"),s.a.createElement("div",{className:"uk-text-center notice"},"Messages sent by the user will not be deleted. A deleted user can not be recovered."),s.a.createElement("div",{className:"padding"})))))},rt=function(){var e=Object(m.useGlobal)("over")[1],t=Object(o.useState)([]),a=Object(b.a)(t,2),n=a[0],r=a[1],c=Object(o.useRef)(),l=Object(m.useGlobal)("searchResults"),i=Object(b.a)(l,2),u=(i[0],i[1]),d=Object(m.useGlobal)("search"),f=Object(b.a)(d,2),p=f[0],v=f[1],E=Object(o.useState)(null),h=Object(b.a)(E,2),O=h[0],k=h[1],N=Object(o.useState)(null),j=Object(b.a)(N,2),x=j[0],S=j[1];Object(o.useEffect)((function(){w(p||null,1e4).then((function(e){r(e.data.users)}))}),[p]);var y=[{name:"First Name",selector:"firstName",sortable:!0},{name:"Last Name",selector:"lastName",sortable:!0},{name:"Email",selector:"email",sortable:!0},{name:"Username",selector:"username",sortable:!0},{name:"Actions",selector:"actions",sortable:!1,cell:function(e){return s.a.createElement("div",{className:"data-actions"},s.a.createElement("a",{className:"edit",onClick:function(){S(e),k("edit")}},"Edit"),s.a.createElement("span",{className:"separator"},"\xa0\xa0-\xa0\xa0"),s.a.createElement("a",{className:"delete",onClick:function(){S(e),k("delete")}},"Delete"))}}],_=[];return n.forEach((function(e){return _.push({id:e._id,firstName:e.firstName,lastName:e.lastName,email:e.email,username:e.username})})),s.a.createElement("div",{className:"admin content uk-flex uk-flex-column"},s.a.createElement($e,{back:function(){return e(!1)}}),s.a.createElement("div",{className:"search-bar uk-flex uk-flex-center uk-flex-middle"},s.a.createElement("div",{className:"icon",onClick:function(){return c.current.focus()}},s.a.createElement(g.D,null)),s.a.createElement("div",{className:"uk-inline search"},s.a.createElement("input",{className:"uk-input uk-border-pill",placeholder:"Search",ref:c,onChange:function(e){v(e.target.value),w(e.target.value).then((function(e){return u(e.data.users)})).catch((function(e){return console.log(e)}))}}))),s.a.createElement("div",{className:"content uk-flex uk-flex-center uk-flex-middle uk-flex-column"},s.a.createElement("div",{className:"data-table",style:{background:"#fff"}},s.a.createElement("div",{className:"data-create"},s.a.createElement("button",{className:"uk-margin-small uk-button uk-button-honey",onClick:function(){return k("create")}},"Create")),s.a.createElement(tt.a,{title:"Admin - Users",columns:y,data:_,defaultSortField:"title",pagination:!0,paginationPerPage:20}))),s.a.createElement(Qe,null),O&&s.a.createElement(nt,{onClose:function(e){e&&w(p||null,1e4).then((function(e){r(e.data.users)})),k(null)},user:x,type:O}))},ct=function(){var e=Object(f.h)(),t=Object(m.useGlobal)("over"),a=Object(b.a)(t,2),n=a[0],r=a[1],c=Object(m.useGlobal)("showPanel")[0],l=Object(m.useGlobal)("showDetails")[0],i=Object(m.useGlobal)("panel")[0],u=Object(T.c)((function(e){return e.rtc.callIncrement})),d=Object(T.c)((function(e){return e.rtc.callData})),p=Object(f.g)();Object(o.useEffect)((function(){d&&Object(m.setGlobal)({audio:!0,video:!1,callDirection:"incoming",meeting:{_id:d.meetingID}}).then((function(){p.replace("/meeting/"+d.meetingID)}))}),[u,d]),Object(o.useEffect)((function(){console.log(e.pathname),"/"!==e.pathname&&r(!0)}),[e]);return s.a.createElement(E.a,null,s.a.createElement("div",{className:"app"},c&&function(){switch(i){case"createGroup":return s.a.createElement(_,null);case"createGroup2":return s.a.createElement(P,null);default:return s.a.createElement(ne,null)}}(),s.a.createElement("div",{className:"main uk-flex uk-flex-column".concat(n?" over":"").concat(!1===n?" exit":"")},s.a.createElement(f.d,null,s.a.createElement(f.b,{exact:!0,path:"/",component:Be}),s.a.createElement(f.b,{exact:!0,path:"/admin",component:rt}),s.a.createElement(f.b,{exact:!0,path:"/meeting/:id",component:Je}),s.a.createElement(f.b,{exact:!0,path:"/room/:id",component:De}),s.a.createElement(f.b,{exact:!0,path:"/room/:id/info",component:ue}),s.a.createElement(f.b,{path:"/",component:Xe})," ")),!e.pathname.endsWith("/info")&&(l||!e.pathname.startsWith("/meeting"))&&s.a.createElement(ue,null)))},lt=function(){Object(m.useGlobal)("version")[0];return s.a.createElement("div",{id:"copyright",className:"uk-position-bottom-center uk-position-small uk-visible@m uk-position-z-index"},s.a.createElement("span",{className:"uk-text-small uk-text-muted"},"\xa9 2020 ",O.brand||"Zaions"))},ot=function(){return s.a.createElement("div",{className:"uk-text-center uk-margin logo"},s.a.createElement("img",{src:ce.a,alt:"Logo"}))},st=function(e){var t=e.icon,a=e.placeholder,n=e.type,r=e.onChange;return s.a.createElement("div",{className:"uk-margin-small"},s.a.createElement("div",{className:"uk-inline uk-width-1-1"},s.a.createElement("span",{className:"uk-form-icon uk-form-icon-flip","data-uk-icon":"icon: ".concat(t),onChange:r}),s.a.createElement("input",{className:"uk-input uk-border-pill",required:!0,placeholder:a,type:n,onChange:r})))},it=(a(292),function(e,t){return x()({method:"post",url:(O.url||"")+"/api/login",data:{email:e,password:t}})}),ut=function(e){return x()({method:"post",url:(O.url||"")+"/api/register",data:e})},mt=a(38),dt=a.n(mt),ft=function(e){e?x.a.defaults.headers.common.Authorization="Bearer ".concat(e):delete x.a.defaults.headers.common.Authorization},pt=a(148),bt=a.n(pt),vt=a(51),Et=a(97),ht={sheet:null},gt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ht,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case U.SET_EMOJI:return Object(V.a)(Object(V.a)({},e),{},{sheet:t.sheet});default:return e}},Ot={io:null,room:null,messages:[],rooms:[],id:null,onlineUsers:[],refreshMeetings:null},kt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ot,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case U.IO_INIT:return Object(V.a)(Object(V.a)({},e),{},{io:t.io,id:t.io.id});case U.SET_ROOMS:return Object(V.a)(Object(V.a)({},e),{},{rooms:t.rooms});case U.SET_ROOM:return Object(V.a)(Object(V.a)({},e),{},{room:t.room});case U.SET_MESSAGES:return Object(V.a)(Object(V.a)({},e),{},{messages:t.messages});case U.MORE_MESSAGES:return Object(V.a)(Object(V.a)({},e),{},{messages:[].concat(Object(h.a)(t.messages),Object(h.a)(e.messages))});case U.MESSAGE:return Object(V.a)(Object(V.a)({},e),{},{messages:[].concat(Object(h.a)(e.messages),[t.message])});case U.ONLINE_USERS:return Object(V.a)(Object(V.a)({},e),{},{onlineUsers:t.data});case U.REFRESH_MEETINGS:return Object(V.a)(Object(V.a)({},e),{},{refreshMeetings:t.timestamp});default:return e}},Nt={roomsWithNewMessages:[],typing:null},jt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Nt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case U.SET_TYPING:return Object(V.a)(Object(V.a)({},e),{},{typing:t.typing});case U.MESSAGES_ADD_ROOM_UNREAD:return Object(V.a)(Object(V.a)({},e),{},{roomsWithNewMessages:[].concat(Object(h.a)(e.roomsWithNewMessages),[t.roomID])});case U.MESSAGES_REMOVE_ROOM_UNREAD:return Object(V.a)(Object(V.a)({},e),{},{roomsWithNewMessages:e.roomsWithNewMessages.filter((function(e){return e!==t.roomID}))});default:return e}},xt=a(71),wt={producers:[],lastLeave:null,roomID:null,consumers:[],consumersTimestamp:null,peers:{},increment:0,callIncrement:0,callData:null,answerIncrement:0,answerData:0,lastLeaveType:"leave",counterpart:null,closingState:!1,closed:!0},St=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:wt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case U.RTC_CLOSE:return Object(V.a)(Object(V.a)({},e),{},{closingState:!e.closed});case U.RTC_PRODUCER:return Object(V.a)(Object(V.a)({},e),{},{producers:[].concat(Object(h.a)(e.producers),[t.data]),closed:!1});case U.RTC_PRODUCERS:return Object(V.a)(Object(V.a)({},e),{},{producers:[].concat(Object(h.a)(e.producers),Object(h.a)(t.producers)),closed:!1});case U.RTC_RESET_PRODUCERS:return Object(V.a)(Object(V.a)({},e),{},{producers:Object(h.a)(t.producers),lastLeave:t.producerID||t.socketID,lastLeaveType:t.lastLeaveType||"leave",increment:e.increment+1});case U.RTC_ROOM_ID:return Object(V.a)(Object(V.a)({},e),{},{roomID:t.roomID,closed:!1});case U.RTC_CONSUMERS:return e.consumersTimestamp&&J(e.consumersTimestamp).isAfter(J(t.consumers.timestamp))?e:Object(V.a)(Object(V.a)({},e),{},{consumers:t.consumers.content,peers:t.peers||e.peers,consumersTimestamp:t.consumers.timestamp,closed:!1});case U.RTC_NEW_PEER:return Object(V.a)(Object(V.a)({},e),{},{peers:Object(V.a)(Object(V.a)({},e.peers),{},Object(xt.a)({},t.data.socketID,t.data)),closed:!1});case U.RTC_CALL:return Object(V.a)(Object(V.a)({},e),{},{callIncrement:e.callIncrement+1,callData:t.data,closed:!1,closingState:!1});case U.RTC_ANSWER:return Object(V.a)(Object(V.a)({},e),{},{answerIncrement:e.answerIncrement+1,answerData:t.data,closed:!1,closingState:!1});case U.RTC_SET_COUNTERPART:return Object(V.a)(Object(V.a)({},e),{},{counterpart:t.counterpart,closed:!1});case U.RTC_LEAVE:return wt;default:return e}},yt=Object(vt.b)({emoji:gt,io:kt,messages:jt,rtc:St}),_t=window.__REDUX_DEVTOOLS_EXTENSION__?Object(vt.c)(Object(vt.a)(Et.a),window.__REDUX_DEVTOOLS_EXTENSION__()):Object(vt.a)(Et.a),Ct=Object(vt.d)(yt,_t),Dt=a(149),Gt=a.n(Dt),It=a(318).promise,Tt=function(e){return function(t){dt()(e);var a=bt()((O.url||"")+"/");a.request=It(a),a.on("connect",(function(){a.emit("authenticate",{token:e}),console.log("IO connected")})),a.on("authenticated",(function(){console.log("IO authenticated"),t({type:U.IO_INIT,io:a})})),a.on("message-in",(function(e){var t=e.room,a=e.message,n=Ct.getState().io.room,r=document.createElement("audio");r.style.display="none",r.src=Gt.a,r.autoplay=!0,r.onended=function(){return r.remove()},document.body.appendChild(r),n&&n._id===t._id||Ct.dispatch({type:U.MESSAGES_ADD_ROOM_UNREAD,roomID:t._id}),n&&(n._id===t._id&&Ct.dispatch({type:U.MESSAGE,message:a}),K().then((function(e){return Ct.dispatch({type:U.SET_ROOMS,rooms:e.data.rooms})})).catch((function(e){return console.log(e)})))})),a.on("newProducer",(function(e){console.log("newProducer",e),e.socketID!==a.id&&Ct.dispatch({type:U.RTC_PRODUCER,data:e})})),a.on("leave",(function(e){console.log("leave",e);var t=Ct.getState().rtc.producers;t=t.filter((function(t){return t.socketID!==e.socketID})),console.log("producers after leave",t),Ct.dispatch({type:U.RTC_RESET_PRODUCERS,producers:t,socketID:e.socketID})})),a.on("consumers",(function(e){console.log("consumers",e),Ct.dispatch({type:U.RTC_CONSUMERS,consumers:e})})),a.on("newPeer",(function(e){console.log("newPeer",e),Ct.dispatch({type:U.RTC_NEW_PEER,data:e})})),a.on("call",(function(e){console.log("call",e),Ct.dispatch({type:U.RTC_SET_COUNTERPART,counterpart:e.counterpart}),Ct.dispatch({type:U.RTC_CALL,data:e})})),a.on("close",(function(e){console.log("close",e),Ct.dispatch({type:U.RTC_CLOSE,data:e})})),a.on("answer",(function(e){console.log("answer",e),Ct.dispatch({type:U.RTC_ANSWER,data:e})})),a.on("remove",(function(e){console.log("remove",e.producerID);var t=Ct.getState().rtc.producers;t=t.filter((function(t){return t.producerID!==e.producerID})),console.log("producers after remove",t),Ct.dispatch({type:U.RTC_RESET_PRODUCERS,producers:t,socketID:e.socketID,lastLeaveType:"remove",producerID:e.producerID})})),a.on("onlineUsers",(function(e){Ct.dispatch({type:U.ONLINE_USERS,data:e})})),a.on("refresh-meetings",(function(e){Ct.dispatch({type:U.REFRESH_MEETINGS,timestamp:e.timestamp})})),a.on("user-deleted",Object(G.a)(D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return localStorage.removeItem("token"),e.next=3,Object(m.setGlobal)({token:null,user:{}});case 3:case"end":return e.stop()}}),e)})))),a.on("typing",(function(e){Ct.getState().io.room&&e.roomID===Ct.getState().io.room._id&&(e.isTyping?(clearTimeout(window.typingTimeout),window.typingTimeout=setTimeout((function(){t({type:U.SET_TYPING,typing:!1})}),1e4)):clearTimeout(window.typingTimeout),t({type:U.SET_TYPING,typing:e.isTyping}))})),a.on("disconnected",(function(){})),window.onbeforeunload=function(){a.emit("leave",{socketID:a.id,roomID:Ct.getState().rtc.roomID})}}},Rt=function(){var e=Object(T.b)(),t=Object(d.useToasts)().addToast,a=Object(o.useState)(""),n=Object(b.a)(a,2),r=n[0],c=n[1],l=Object(o.useState)(""),i=Object(b.a)(l,2),u=i[0],p=i[1],v=Object(o.useState)(!0),h=Object(b.a)(v,2),g=h[0],k=h[1],N=Object(o.useState)({}),j=Object(b.a)(N,2),x=j[0],w=j[1],S=Object(o.useState)(""),y=Object(b.a)(S,2),_=y[0],C=y[1],I=Object(o.useState)(""),R=Object(b.a)(I,2),M=R[0],A=R[1],U=Object(o.useState)(""),P=Object(b.a)(U,2),L=P[0],z=P[1],q=Object(o.useState)(""),F=Object(b.a)(q,2),W=F[0],V=F[1],J=Object(o.useState)(""),Z=Object(b.a)(J,2),H=Z[0],B=Z[1],K=Object(o.useState)(""),Y=Object(b.a)(K,2),X=Y[0],$=Y[1],Q=Object(o.useState)({}),ee=Object(b.a)(Q,2),te=ee[0],ae=ee[1],ne=Object(m.useGlobal)("token")[1],re=Object(m.useGlobal)("user")[1],ce=Object(m.useGlobal)("entryPath"),le=Object(b.a)(ce,2),oe=le[0],se=le[1],ie=Object(f.g)();Object(o.useEffect)((function(){window.self!==window.top&&t(s.a.createElement("a",{href:"#",onClick:function(e){e.preventDefault(),window.top.location.href=O.url}},s.a.createElement("b",null,"Click here to remove the Envato frame or meetings will not work properly.")),{appearance:"warning",autoDismiss:!1})}),[]);var ue=function(){var t=Object(G.a)(D.a.mark((function t(a){var n,c;return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),t.prev=1,t.next=4,it(r,u);case 4:return n=t.sent,g&&localStorage.setItem("token",n.data.token),g&&localStorage.setItem("user",JSON.stringify(dt()(n.data.token))),w({}),ft(n.data.token),re(dt()(n.data.token)),ne(n.data.token),e(Tt(n.data.token)),ie.replace(["/login","/"].includes(oe)?"/":oe),t.next=15,se(null);case 15:t.next=22;break;case 17:t.prev=17,t.t0=t.catch(1),c={},t.t0.response&&"object"===typeof t.t0.response.data?c=t.t0.response.data:c.generic="Could not connect to server.",w(c);case 22:case"end":return t.stop()}}),t,null,[[1,17]])})));return function(e){return t.apply(this,arguments)}}(),me=function(){var t=Object(G.a)(D.a.mark((function t(a){var n,r;return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),t.prev=1,t.next=4,ut({username:_,email:M,firstName:L,lastName:W,password:H,repeatPassword:X});case 4:return t.next=6,it(M,H);case 6:n=t.sent,ae({}),g&&localStorage.setItem("token",n.data.token),ft(n.data.token),re(dt()(n.data.token)),ne(n.data.token),e(Tt(n.data.token)),t.next=20;break;case 15:t.prev=15,t.t0=t.catch(1),r={},t.t0.response&&"object"===typeof t.t0.response.data?r=t.t0.response.data:r.generic="Could not connect to server.",ae(r);case 20:case"end":return t.stop()}}),t,null,[[1,15]])})));return function(e){return t.apply(this,arguments)}}(),de=Object.keys(x).map((function(e){return s.a.createElement("div",{className:"uk-text-center",key:e},s.a.createElement("span",{className:"uk-text-danger"},x[e]))})),fe=Object.keys(te).map((function(e){return s.a.createElement("div",{className:"uk-text-center",key:e},s.a.createElement("span",{className:"uk-text-danger"},te[e]))}));return s.a.createElement(E.a,null,s.a.createElement("div",{className:"login uk-cover-container uk-background-secondary uk-flex uk-flex-center uk-flex-middle uk-overflow-hidden uk-light"},s.a.createElement("div",{className:"uk-position-cover uk-overlay-primary"}),s.a.createElement("div",{className:"login-scrollable uk-flex uk-flex-center uk-flex-middle uk-position-z-index"},s.a.createElement(lt,null),s.a.createElement("div",{className:"login-inner uk-width-medium uk-padding-small","data-uk-scrollspy":"cls: uk-animation-fade"},s.a.createElement(ot,null),s.a.createElement("div",{className:"toggle-credits"},s.a.createElement("form",{className:"toggle-class",onSubmit:ue},s.a.createElement("fieldset",{className:"uk-fieldset"},de,s.a.createElement(st,{icon:"user",placeholder:"Username (or email)",type:"text",onChange:function(e){return c(e.target.value)}}),s.a.createElement(st,{icon:"lock",placeholder:"Password",type:"password",onChange:function(e){return p(e.target.value)}}),s.a.createElement("div",{className:"uk-margin-small"},s.a.createElement("label",null,s.a.createElement("input",{className:"uk-checkbox",type:"checkbox",onChange:function(e){return k(e.target.checked)},checked:g})," Keep me logged in")),s.a.createElement("div",{className:"uk-margin-bottom"},s.a.createElement("button",{type:"submit",className:"uk-button uk-button-primary uk-border-pill uk-width-1-1"},"LOG IN")))),s.a.createElement("form",{className:"toggle-class",onSubmit:me,hidden:!0},fe,s.a.createElement(st,{icon:"user",placeholder:"Username",type:"text",onChange:function(e){return C(e.target.value)}}),s.a.createElement(st,{icon:"mail",placeholder:"Email",type:"email",onChange:function(e){return A(e.target.value)}}),s.a.createElement(st,{icon:"pencil",placeholder:"First Name",type:"text",onChange:function(e){return z(e.target.value)}}),s.a.createElement(st,{icon:"pencil",placeholder:"Last Name",type:"text",onChange:function(e){return V(e.target.value)}}),s.a.createElement(st,{icon:"lock",placeholder:"Password",type:"password",onChange:function(e){return B(e.target.value)}}),s.a.createElement(st,{icon:"lock",placeholder:"Repeat Password",type:"password",onChange:function(e){return $(e.target.value)}}),s.a.createElement("div",{className:"uk-margin-bottom"},s.a.createElement("button",{type:"submit",className:"uk-button uk-button-primary uk-border-pill uk-width-1-1"},"REGISTER"))),s.a.createElement("form",{className:"toggle-password",hidden:!0},s.a.createElement(st,{icon:"mail",placeholder:"Email",type:"email"}),s.a.createElement("div",{className:"uk-margin-bottom"},s.a.createElement("button",{type:"submit",className:"uk-button uk-button-primary uk-border-pill uk-width-1-1"},"SEND CODE"))),s.a.createElement("div",null,s.a.createElement("div",{className:"uk-text-center"},s.a.createElement("a",{className:"uk-link-reset uk-text-small toggle-class","data-uk-toggle":"target: .toggle-class ;animation: uk-animation-fade"},"Need an account? Register now!"),s.a.createElement("a",{className:"uk-link-reset uk-text-small toggle-class","data-uk-toggle":"target: .toggle-class ;animation: uk-animation-fade",hidden:!0},s.a.createElement("span",{"data-uk-icon":"arrow-left"})," Back to Login")))),s.a.createElement("form",{className:"toggle-credits uk-text-center",hidden:!0},s.a.createElement("span",null,"Everyone has a sweet side",s.a.createElement("br",null),"Everything can taste like honey",s.a.createElement("br",null)),s.a.createElement("br",null),"Special thanks to all of the people who believed that Chat Zaions was possible and who made it possible.",s.a.createElement("br",null),s.a.createElement("br",null),"This Login / Register page uses ",s.a.createElement("a",{href:"https://github.com/zzseba78/Kick-Off",target:"_blank",rel:"noopener noreferrer"},"Kick-Off")," by zzseba78",s.a.createElement("br",null),s.a.createElement("br",null),"The default background image is from ",s.a.createElement("a",{href:"https://picsum.photos/",target:"_blank",rel:"noopener noreferrer"},"Picsum Photos"),s.a.createElement("br",null),s.a.createElement("br",null),"A big thank you to all contributors to React, Redux, Socket.IO, Emoji Mart, Axios, SASS and Moment"),s.a.createElement("div",null,s.a.createElement("div",{className:"uk-margin-top uk-text-center"},s.a.createElement("a",{className:"uk-link-reset uk-text-small toggle-credits","data-uk-toggle":"target: .toggle-credits ;animation: uk-animation-fade",hidden:!0},s.a.createElement("span",{"data-uk-icon":"arrow-left"})," Close Credits")))))))},Mt=function(){var e=Object(T.b)(),t=Object(d.useToasts)().addToast,a=Object(T.c)((function(e){return e.io.io})),n=Object(m.useGlobal)("token")[0],r=Object(m.useGlobal)("entryPath")[1],c=n&&s.a.createElement(f.a,{to:"/"}),l=!n&&s.a.createElement(f.a,{to:"/login"});if(["dark","light"].includes(O.theme)||(O.theme="light"),Object(o.useEffect)((function(){if(a&&Object(m.getGlobal)().user&&n){var e=0,t=setInterval((function(){document.hasFocus()?0!==e&&(e=0,a.emit("status",{status:"online"})):10===++e&&a.emit("status",{status:"away"})}),1e3);return function(){return clearInterval(t)}}}),[a,n]),Object(o.useEffect)((function(){return function(){try{Object(m.getGlobal)().audioStream&&Object(m.getGlobal)().audioStream.getTracks().forEach((function(e){return e.stop()}))}catch(e){}try{Object(m.getGlobal)().videoStream&&Object(m.getGlobal)().videoStream.getTracks().forEach((function(e){return e.stop()}))}catch(e){}}}),[]),!window.loaded){r(window.location.pathname);var i,u=window.location.pathname.split("/"),b=u[1],v=u[2];if("login"===b&&v&&v.length>20)try{if("object"!==typeof(i=dt()(v))||"string"!==typeof i.id)return;ft(v),localStorage.setItem("token",v),localStorage.setItem("user",JSON.stringify(i)),Object(m.setGlobal)({user:i,token:v}).then((function(){e(Tt(v))}))}catch(E){t("Invalid token provided in URL. You can still login manually.",{appearance:"error",autoDismiss:!0})}window.loaded=!0}return s.a.createElement("div",{className:"theme ".concat(O.theme)},s.a.createElement(p.a,null,s.a.createElement(f.d,null,s.a.createElement(f.b,{path:"/login"},c,!c&&s.a.createElement(Rt,null)),s.a.createElement(f.b,{path:"/"},l,!l&&s.a.createElement(ct,null)))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var At=a(150),Ut=a.n(At),Pt=a(151),Lt=a.n(Pt);(function(){var e=Object(G.a)(D.a.mark((function e(){var t,a,n,r,c,l,o;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(document.addEventListener("gesturestart",(function(e){e.preventDefault()})),"Chat Zaions"!==localStorage.getItem("app")&&(localStorage.clear(),localStorage.setItem("app","Chat Zaions")),t=localStorage.getItem("token"),a=localStorage.getItem("user"),n=a?JSON.parse(a):null,!t){e.next=18;break}return r=dt()(t),e.prev=7,e.next=10,x()({method:"post",url:(O.url||"")+"/api/check-user",data:{id:r.id}});case 10:l=e.sent,c=l.data,e.next=17;break;case 14:e.prev=14,e.t0=e.catch(7),c=null;case 17:c&&!c.error||(localStorage.removeItem("token"),localStorage.removeItem("user"),t=localStorage.getItem("token"),a=localStorage.getItem("user"),n=a?JSON.parse(a):null);case 18:t&&(ft(t),Ct.dispatch(Tt(t))),o={version:"1.0.0",entryPath:window.location.pathname,token:t,user:n||(t?dt()(t):{}),rooms:[],searchResults:[],favorites:[],meetings:[],nav:"rooms",search:"",over:null,isPicker:!1,messages:[],streams:[],inCall:!1,video:!0,audio:!0,audioStream:null,videoStream:null,screenStream:null,callStatus:null,counterpart:null,callDirection:null,meeting:null,showPanel:!0,panel:"standard",newGroupUsers:[]},Object(m.setGlobal)(o).then((function(){return console.log("Global state init complete!",o)}));case 21:case"end":return e.stop()}}),e,null,[[7,14]])})));return function(){return e.apply(this,arguments)}})()().then((function(){Ut.a.use(Lt.a),u.a.render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(T.a,{store:Ct},s.a.createElement(d.ToastProvider,{autoDismiss:!0,autoDismissTimeout:6e3,placement:"top-right"},s.a.createElement(Mt,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}))},43:function(e,t,a){e.exports=a.p+"static/media/logo.706acf1f.png"},81:function(e,t,a){e.exports=a.p+"static/media/placeholder.fe38aaa3.jpg"}},[[156,1,2]]]);
//# sourceMappingURL=main.d864035e.chunk.js.map